<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>JAKA通讯使用手册 | 文档</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="JAKA 文档">
    <link rel="preload" href="/assets/css/0.styles.27db33e3.css" as="style"><link rel="preload" href="/assets/js/app.97ce11a3.js" as="script"><link rel="preload" href="/assets/js/3.5fb538b3.js" as="script"><link rel="preload" href="/assets/js/2.e2beffe6.js" as="script"><link rel="prefetch" href="/assets/js/10.6f0c2873.js"><link rel="prefetch" href="/assets/js/11.a85eb502.js"><link rel="prefetch" href="/assets/js/12.c58c1a87.js"><link rel="prefetch" href="/assets/js/13.655f857d.js"><link rel="prefetch" href="/assets/js/14.739f33b9.js"><link rel="prefetch" href="/assets/js/15.11b90607.js"><link rel="prefetch" href="/assets/js/16.8bcbb813.js"><link rel="prefetch" href="/assets/js/17.39817907.js"><link rel="prefetch" href="/assets/js/18.863ab3ec.js"><link rel="prefetch" href="/assets/js/19.a4027bee.js"><link rel="prefetch" href="/assets/js/4.271f7e9f.js"><link rel="prefetch" href="/assets/js/5.70e8c141.js"><link rel="prefetch" href="/assets/js/6.3d0d8e04.js"><link rel="prefetch" href="/assets/js/7.95f5c988.js"><link rel="prefetch" href="/assets/js/8.c92dac8b.js"><link rel="prefetch" href="/assets/js/9.ec20314d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.27db33e3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-6 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/logo.png" alt="文档" class="logo"> <span class="site-name">文档</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="nav-space-between ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-18 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-submenu-selected"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          Languages
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <ul class="extra-group"><!----> <!----></ul></nav></div></div> <!----></header> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/guide/quick_start.html" title="快速入门" class="sidebar-link">快速入门</a></li><li><a href="/guide/errinfo.html" title="事件码及含义" class="sidebar-link">事件码及含义</a></li><li><a href="/guide/jks.html" title="JAKA编程脚本" class="sidebar-link">JAKA编程脚本</a></li><li><a href="/guide/bus.html" aria-current="page" title="JAKA通讯使用手册" class="active sidebar-link">JAKA通讯使用手册</a></li></ul> </aside> <main class="page has-page-anchor"> <div class="theme-antdocs-content content__default"><h1 id="jaka通讯使用手册"><a href="#jaka通讯使用手册" class="header-anchor">#</a> JAKA通讯使用手册</h1> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>为了帮助用户更好地使用JAKA的通讯功能，针对市面主流的PLC，分别使用其上位机验证其与JAKA的数据交互。教程仅选用了部分型号，即使是同一厂商的PLC，由于通讯参数和设备版本的问题，使用方法不完全相同，因此本教程仅供初步使用的参考，更进一步的应用请联系PLC的本地供应商。</p> <p>本次验证基于以下PLC型号，表中分别给出了使用的固件版本和上位机的软件版本，推荐在已经验证过功能的版本或更高版本使用。</p> <table><thead><tr><th></th> <th>PLC型号</th> <th>固件版本</th> <th>软件版本</th></tr></thead> <tbody><tr><td>罗克韦尔</td> <td>5370 L3 1769-L33ER</td> <td>20.18</td> <td>RSLogix 5000 V20.00.00 (CPR 9 SR 5)</td></tr> <tr><td>西门子</td> <td>6ES7317-2EK14-0AB0</td> <td>3.2.18</td> <td>TIA Portal V16</td></tr> <tr><td>三菱</td> <td>CPU:FX5U-80MT/DSS</td> <td>1.2450</td> <td>GX Works3 Version 1.090UEtherNetIPConfiguration Tool for FX5-ENET IP V1.00A</td></tr> <tr><td>扩展:FX5-ENET/IP</td> <td>1.1</td> <td></td> <td></td></tr> <tr><td>施耐德</td> <td>TM241CE24R</td> <td>5.1.10.10</td> <td>EcoStruxure Mchine Expert Version 2.1</td></tr> <tr><td>欧姆龙</td> <td>CPU:CP1H-X40DT-D</td> <td>1.3</td> <td>CX-Programmer 9.50</td></tr> <tr><td>扩展:CJ1W-EIP21</td> <td>3.0</td> <td></td> <td></td></tr> <tr><td>基恩士</td> <td>CPU:KV-8000</td> <td>2.602</td> <td>KV STUDIO 11.62</td></tr> <tr><td>扩展:KV-XLE02</td> <td>1.400</td> <td></td> <td></td></tr> <tr><td>台达</td> <td>AS228T-A</td> <td>1.12.50</td> <td>ISPSoft Version 3.15COMMGR 1.12</td></tr> <tr><td>汇川</td> <td>Easy522‑0808TN</td> <td>5.67.0.0</td> <td>Autoshop V4.8.1.0</td></tr></tbody></table> <p>JAKA设备的EtherNet/IP支持作为Adapter使用，Profinet支持作为Device使用，均为普遍意义上的从站，Modbus功能支持主从功能。由于Modbus RTU与Modbus TCP在使用流程上主要区别于连接参数，因此暂时仅对Modbus TCP进行验证，另外多数PLC厂商的Modbus主站通过梯形图触发通信，因此针对每家厂商未作重复验证。特定PLC型号未在教程中提及的通讯功能并不代表JAKA不支持，而是PLC并未集成此功能或验证困难。</p> <h3 id="环境搭建"><a href="#环境搭建" class="header-anchor">#</a> 环境搭建</h3> <p>节卡机器人的电控柜和PLC建立通讯后，PLC可以实时读取机器人的各项性能参数， 例如：机器人状态，各关节的角度、速度、温度，以及TCP的位置、速度和受力值，同时，PLC也能通过不同类型数据的寄存器与控制柜进行数据交互。</p> <p>设备间的简易连接示意如下，需要保证PLC、上位机和控制柜在同一网段内，下文所述的使用方法和步骤均基于三者之间可互相访问。</p> <p><img src="/assets/img/image-20230220170602938.830c0778.png" alt="image-20230220170602938"></p> <p>节卡机器人控制柜通讯功能建议使用控制柜的底部网口，JAKA Zu APP（下文简称APP）也可以通过底部网口与控制柜连接，但为了避免APP与控制柜的数据传输影响通信功能，建议APP使用面板上网口或WIFI与控制柜相连。</p> <p>注：底部网口需要处于处于激活状态（连上电脑或路由器），才能使用相关通信功能。</p> <h3 id="使能ethernet-ip功能"><a href="#使能ethernet-ip功能" class="header-anchor">#</a> 使能EtherNet/IP功能</h3> <p>节卡机器人默认情况下，Ethernet/IP功能处于关闭状态，使能的具体步骤如下：</p> <p>步骤一：打开最新版本JAKA Zu APP，点击APP右上角的未连接搜索控制器IP地址。</p> <p><img src="/assets/img/image-20230221094819134.9c78fbea.png" alt="image-20230221094819134"></p> <p>步骤二：选中控制柜并输入管理员密码使APP与控制柜相连。</p> <p><img src="/assets/img/image-20230221094852245.2c35efa5.png" alt="image-20230221094852245"></p> <p>步骤三：在APP界面， 点击设置-&gt;硬件与通讯-&gt;Ethernet/IP设置， 开启使能按键并点击确定按钮，手动重启控制柜。重新连接控制柜后可查看状态项。状态为未成功连接主站时，代表EtherNet/IP已成功使能，等待主站连接。</p> <p><img src="/assets/img/image-20230221094909935.ca1c3501.png" alt="image-20230221094909935"></p> <p>Profinet和Modbus的使能同理，均在硬件与通信开启，在使能和配置完通讯参数后，需要对控制器进行重启让功能生效。</p> <h2 id="io数量配置方法"><a href="#io数量配置方法" class="header-anchor">#</a> IO数量配置方法</h2> <h3 id="ethernet-ip"><a href="#ethernet-ip" class="header-anchor">#</a> EtherNet/IP</h3> <p>在地址分配表中，数据类型排列的顺序为：DIO布尔型、AIO整型和AIO浮点数型。其中：</p> <p>DIO：布尔型，占1bit，每8个DIO组成一个字节，因此DI和DO的IO数量配置需为8*n个，n为正整数，使对应的DI和DO数据长度为整数字节，</p> <p>AIO：整型和浮点数型均占4个字节。</p> <p>按照使用场景，EtherNet/IP的IO数量是可配置的。在usersetting中，如果Mode = 0，代表EIP使用标准的IO数量，如果Mode = 1，代表可以配置IO数量。</p> <p>scanner需要导入eds文件以与控制器的adapter匹配，目前JAKA提供以下eds文件，其含义和应用场景分别为：</p> <h4 id="jakarobot-eds"><a href="#jakarobot-eds" class="header-anchor">#</a> JAKARobot.eds</h4> <p>标准版的eds文件，参数不可配置不可修改，为固定值，具体IO数量定义在usersetting中：</p> <p>[EIP]</p> <p>Enable = 1</p> <p>Mode = 0</p> <p>DI_NUM = 64</p> <p>DO_NUM = 64</p> <p>AI_INT_NUM = 24</p> <p>AI_FLOAT_NUM = 24</p> <p>AO_INT_NUM = 24</p> <p>AO_FLOAT_NUM = 24</p> <p>其中DO和AO输出的数据长度总和最大为204个字节， DI和AI输入的数据总长度总和最大为492个字节。</p> <h4 id="jakarobotsetup-eds"><a href="#jakarobotsetup-eds" class="header-anchor">#</a> JAKARobotSetup.eds</h4> <p>定制版本的eds文件，IO数量可以配置，需要在控制器内将usersetting的mode改为1，再修改IO数量。</p> <p>其中DO和AO输出的数据长度总和最大为492个字节， DI和AI输入的数据总长度总和最大为492个字节。</p> <h3 id="profinet"><a href="#profinet" class="header-anchor">#</a> Profinet</h3> <p>节卡机器人Profinet IO数据传输的控制，首先请参考节卡机器人地址分配表的EXCEL文档，由4个sheet表组成，分别是表格说明、Robot2PLC、PLC2Robot以及脚本函数。在Robot2PLC和PLC2Robot表中定义的每个数据占4个字节，即0 ~ 31个Bit位，重点关注内容如下：</p> <p>传输类型： R-&gt;P （Robot-&gt;PLC）或者传输类型 P-&gt;R（PLC-&gt;Robot），表明了数据传输的方向</p> <p>单元模块（Unit Group）： 表明了数据类型和所属模块，数据类型为：机器人状态、安全设置，属于第一个模块。比如：1_R-&gt;P_Robot_Safety， 代表数据模块编号为1，传输方向R-&gt;P （Robot-&gt;PLC），Robot表示机器人状态，Safety表示安全设置，32 Bytes为已使用地址，4 Bytes为预留地址。 其他的单元模块内容与此类似。</p> <p>PLC设置： 包括各个单元模块对应的插槽、子插槽编号和PLC上地址，如1_R-&gt;P_Robot_Safety对应1号插槽，1号子插槽，PLC输入I地址为0 ~ 35 Bytes。</p> <h4 id="di布尔量输入操作"><a href="#di布尔量输入操作" class="header-anchor">#</a> DI布尔量输入操作</h4> <p>Profinet数字输入对应DI 136到DI 199，共64个DI数据。数据传输方向为：PLC数据输出对应控制柜DI数据输入。在PLC2Robot工作表中，传输类型 P-&gt;R（PLC-&gt;Robot），布尔输入寄存器DI 0 ~ 64位于PLC的7号插槽和1号子插槽，PLC的输出地址为0 ~ 7字节, 在Profinet IO的数据通讯模式中，每一个DI数据由1个Bit位控制。</p> <p><img src="/assets/img/image-20230518105055149.42e9237a.png" alt="image-20230518105055149"></p> <p>如上图所示，其他DI数据的操作步骤类似，先提供Profinet功能DI寄存器与PLC输出地址对应表：</p> <table><thead><tr><th>DI输入寄存器</th> <th>插槽</th> <th>子插槽</th> <th>QB地址</th></tr></thead> <tbody><tr><td>DI 136 ~ 143</td> <td>7</td> <td>1</td> <td>0</td></tr> <tr><td>DI 144 ~ 151</td> <td>1</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>DI 192 ~ 199</td> <td>7</td> <td></td> <td></td></tr></tbody></table> <h4 id="ai整数输入操作"><a href="#ai整数输入操作" class="header-anchor">#</a> AI整数输入操作</h4> <p>Profinet有符号模拟量输入为AI 73到AI 104，共计32个数据。在PLC2Robot工作表中,传输类型 P-&gt;R（PLC-&gt;Robot），整数输入寄存器AI 0 ~ 31位于PLC的8号插槽和1号子插槽，PLC的输出地址为12 ~ 139字节, 在Profinet IO的数据通讯模式中，每一个AI整数数据由4个字节控制。</p> <p><img src="/assets/img/image-20230518105217981.ba727286.png" alt="image-20230518105217981"></p> <p>Profinet功能AI整数输入寄存器与PLC输出地址对应表如下：</p> <table><thead><tr><th>AI整数输入寄存器</th> <th>插槽</th> <th>子插槽</th> <th>QD地址</th></tr></thead> <tbody><tr><td>AI 73</td> <td>8</td> <td>1</td> <td>12</td></tr> <tr><td>AI 74</td> <td>16</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>AI 104</td> <td>136</td> <td></td> <td></td></tr></tbody></table> <h4 id="ai浮点数输入操作"><a href="#ai浮点数输入操作" class="header-anchor">#</a> AI浮点数输入操作</h4> <p>Profinet浮点数输入为AI 105到AI 136，共计32个数据。在PLC2Robot工作表中,传输类型 P-&gt;R（PLC-&gt;Robot），浮点数输入寄存器AI 0 ~ 31位于PLC的9号插槽和1号子插槽，PLC的输出地址为140 ~ 247字节, 在Profinet IO的数据通讯模式中，每一个AI浮点数据由4个字节控制。</p> <p><img src="/assets/img/image-20230518105300645.6559d307.png" alt="image-20230518105300645"></p> <p>Profinet功能AI浮点输入寄存器与PLC输出地址对应表如下：</p> <table><thead><tr><th>AI浮点输入寄存器</th> <th>插槽</th> <th>子插槽</th> <th>QD地址</th></tr></thead> <tbody><tr><td>AI 105</td> <td>9</td> <td>1</td> <td>140</td></tr> <tr><td>AI 106</td> <td>144</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>AI 136</td> <td>264</td> <td></td> <td></td></tr></tbody></table> <h4 id="do布尔量输出控制"><a href="#do布尔量输出控制" class="header-anchor">#</a> DO布尔量输出控制</h4> <p>Profinet数字输出对应DO 136到DO 199，总共64个DO数据。数据传输方向为，控制柜的DO数据输出对应PLC的数据输入，在Robot2PLC工作表中，传输类型 R-&gt;P （Robot-&gt;PLC），布尔输出寄存器 DO 0 ~ 64位于PLC的4号插槽和1号子插槽，PLC的输入地址为400 ~ 407字节, 在Profinet IO的数据通讯模式中，每一个DO数据由1个Bit位控制。</p> <p><img src="/assets/img/image-20230518105335789.17f93e9b.png" alt="image-20230518105335789"></p> <p>Profinet功能DO寄存器与PLC输入地址对应表:</p> <table><thead><tr><th>DO输出寄存器</th> <th>插槽</th> <th>子插槽</th> <th>IB地址</th></tr></thead> <tbody><tr><td>DO 136 ~ 143</td> <td>4</td> <td>1</td> <td>400</td></tr> <tr><td>DO 144 ~ 151</td> <td>401</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>DO 192 ~ 199</td> <td>407</td> <td></td> <td></td></tr></tbody></table> <h4 id="ao整数输出操作"><a href="#ao整数输出操作" class="header-anchor">#</a> AO整数输出操作</h4> <p>Profinet有符号模拟量输出为AI 65到AI 96，共计32个数据。在Robot2PLC工作表中，传输类型 R-&gt;P （Robot-&gt;PLC），整数输出寄存器AO 0 ~ 31位于PLC的5号插槽和1号子插槽，PLC的输入地址为412 ~ 539字节, 在Profinet IO的数据通讯模式中，每一个AI整数数据由4个字节控制。</p> <p><img src="/assets/img/image-20230518105409172.6eb5eea7.png" alt="image-20230518105409172"></p> <p>Profinet功能AO整数输出寄存器与PLC输入地址对应表如下：</p> <table><thead><tr><th>AO整数输入寄存器</th> <th>插槽</th> <th>子插槽</th> <th>ID地址</th></tr></thead> <tbody><tr><td>AO 65</td> <td>8</td> <td>1</td> <td>412</td></tr> <tr><td>AO 66</td> <td>416</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>AO 96</td> <td>536</td> <td></td> <td></td></tr></tbody></table> <h4 id="ao浮点数输出操作"><a href="#ao浮点数输出操作" class="header-anchor">#</a> AO浮点数输出操作</h4> <p>Profinet有浮点模拟量输出为AO 97到AI 128，共计32个数据。在Robot2PLC工作表中，传输类型 R-&gt;P （Robot-&gt;PLC），浮点数输出寄存器AO 0 ~ 31位于PLC的6号插槽和1号子插槽，PLC的输入地址为540 ~ 667字节, 在Profinet IO的数据通讯模式中，每一个AI浮点数据由4个字节控制。</p> <p><img src="/assets/img/image-20230518105444324.1f1921db.png" alt="image-20230518105444324"></p> <p>Profinet功能AO浮点数输出寄存器与PLC输入地址对应表如下：</p> <table><thead><tr><th>AO浮点数输出寄存器</th> <th>插槽</th> <th>子插槽</th> <th>ID地址</th></tr></thead> <tbody><tr><td>AO 97</td> <td>6</td> <td>1</td> <td>540</td></tr> <tr><td>AO 98</td> <td>544</td> <td></td> <td></td></tr> <tr><td>……</td> <td>……</td> <td></td> <td></td></tr> <tr><td>AO 128</td> <td>664</td> <td></td> <td></td></tr></tbody></table> <p>上文已经介绍了布尔量、整数和浮点数的读取操作，机器人的状态和安全设置，以及关节和TCP等数据，其数据格式多为整数和浮点， 获取这些数据的操作与Profinet IO的控制相同，只要参考Robot2PLC工作表中PLC的输入地址，在TIA Portal中输入数据对应的地址，注意数据所占的字节长度，就能获取所想要的数据。</p> <h2 id="plc通讯实例"><a href="#plc通讯实例" class="header-anchor">#</a> PLC通讯实例</h2> <h3 id="罗克韦尔5370-l3-1769-l33er"><a href="#罗克韦尔5370-l3-1769-l33er" class="header-anchor">#</a> 罗克韦尔5370 L3 1769-L33ER</h3> <h4 id="ethernet-ip-2"><a href="#ethernet-ip-2" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li><p>在不清楚PLC当前IP地址的情况下，可以使用Wireshark确认PLC的IP地址，使用windows自带的cmd工具ping设备以测试PLC是否处于组网中。如果与控制器和上位机不在同一网段内，请跳至步骤二，尝试修改PLC的IP地址；如果已经处于同一网段内，则至步骤四继续执行。</p></li> <li><p>打开软件RsLinx Classic，点击Config Drivers菜单，在弹出的对话框中， 选择Ethernet/IP Driver， 点击Add New，按照默认配置，完成后点击Ok。<img src="/assets/img/image-20230221093844646.081e8b2b.png" alt="image-20230221093844646"></p></li> <li><p>点击网络节点图标，弹出WRWho对会话框。点击ABETHIP_1, 会刷新出PLC和Ethernet/IP的模块信息，连接正常表示已正确组网。右键点击PLC可以修改其IP地址，使其与控制器和上位机处于同一子网段内。</p></li></ol> <p><img src="/assets/img/image-20230221093902444.f3efcbd0.png" alt="image-20230221093902444"></p> <ol start="4"><li>打开BOOTP-DHCP Server软件，将自动搜索与电脑连接的设备。</li></ol> <p><img src="/assets/img/image-20230221093943306.0838341f.png" alt="image-20230221093943306"></p> <p>注：如自动搜索未发现PLC的MAC地址，请关闭电脑的防火墙功能，手动输入MAC地址。在下半栏选中IP地址，然后点击Disable BOOTP/DHCP。</p> <ol start="5"><li>打开RsLinx Classic Launch Panel软件， 点击Start。</li></ol> <p><img src="/assets/img/image-20230221094002051.3bd7ff8f.png" alt="image-20230221094002051"></p> <ol start="6"><li>点击菜单栏工具，选择安装EDS文件，注册EDS文件， 一直点击下一步，直到完成配置。</li></ol> <p><img src="/assets/img/image-20230221094022980.f1bd2afa.png" alt="image-20230221094022980"></p> <p><img src="/assets/img/image-20230221094036396.3d2077be.png" alt="image-20230221094036396"></p> <ol start="7"><li>打开RsLogix 5000软件，创建新项目。选择所使用的PLC型号，输入项目名称，浏览项目保存位置，点击确认。</li></ol> <p><img src="/assets/img/image-20230221094054717.cbf36a86.png" alt="image-20230221094054717"></p> <ol start="8"><li>在左侧栏右键点击以太网，选择新建module，在弹出的窗口中找到模块JAKA Ethernet/IP Adapter, 点击创建，输入模块名称，注意此处IP地址需要与控制柜的Ethernet/IP地址相同。</li></ol> <p><img src="/assets/img/image-20230221094147644.934513bd.png" alt="image-20230221094147644"></p> <p><img src="/assets/img/image-20230221094158456.155cd2a1.png" alt="image-20230221094158456"></p> <p><img src="/assets/img/image-20230221094206931.8375284a.png" alt="image-20230221094206931"></p> <ol start="9"><li>点击更改按钮，可设置数据的类型，为了便于数据显示，这里选择DINT类型。</li></ol> <p><img src="/assets/img/image-20230221094219019.eada515d.png" alt="image-20230221094219019"></p> <p>注：如果使用定制版本，需要手动配置EIP的模块，则配置如下：</p> <p>PLC到EIP的输出ID为100</p> <p>EIP到PLC的输入ID为101</p> <p>PLC输出最大字节数为492字节</p> <p>PLC输入的最大字节数为492字节</p> <ol start="10"><li>点击网络节点，弹出活动页对话框，选择 PLC模块， 然后点击联机，弹出对话框，下载程序。</li></ol> <p><img src="/assets/img/image-20230221094234010.9655e9e5.png" alt="image-20230221094234010"></p> <ol start="11"><li>选择联机，使PLC处于运行模式，连接状态正常之后，右键点击控制器标签，选择监控Tag，可以看到PLC从机器人读取到了部分数据。</li></ol> <p><img src="/assets/img/image-20230221094252406.f0daf346.png" alt="image-20230221094252406"></p> <p><img src="/assets/img/image-20230221094417189.b8de7cd7.png" alt="image-20230221094417189"></p> <ol start="12"><li>在APP上打开Ethernet/IP数字输出DO1和DO2按钮，设置整数 AO1为123。</li></ol> <p><img src="/assets/img/image-20230221094348426.f3dba031.png" alt="image-20230221094348426"></p> <ol start="13"><li>查看RsLogix 5000相应的数据,，I.Data[72]和I.Data[75]显示相应的数据正确。数据的地址可参考文件<strong>节卡机器人EthernetIP地址分配表</strong>确定。</li></ol> <p><img src="/assets/img/image-20230221094452237.461f6631.png" alt="image-20230221094452237"></p> <h4 id="modbus-tcp"><a href="#modbus-tcp" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="主站"><a href="#主站" class="header-anchor">#</a> 主站</h5> <p>AB的PLC自身均不支持Modbus TCP通讯，使用AB PLC需要配第三方的协议转换网关将ModBusTCP协议转换为AB自己的Ethernet/IP协议。因此罗克韦尔PLC首先必须有具备EtherNet/IP协议的以太网接口。</p> <p>从Logix5000编程软件15版本（实测20版本及以上）以后，对于CompactLogix和Controllogix系列的PLC，支持了使用PLC程序编写出来的ModbusTCP协议通讯，目前来看，支持该通讯的协议的产品和版本主要有：</p> <p><img src="/assets/img/image-20230518092542471.9e9144e2.png" alt="image-20230518092542471"></p> <p>以上产品刷对应固件后即可支持ModbusTCP协议，并且可作为Master和Slave与其他第三方设备进行通讯，AB官方提供的例程分为Master和Slave两部分，可按需分别使用。Master功能部分可能会占用PLC内200-230K的存储空间，Slave功能部分可能会占用PLC的280-300K空间</p> <p>由上可知，罗克韦尔不支持原生的Modbus Tcp协议，需要通过其EtherNet\IP的以太网端口实现。</p> <p>可以自行编写PLC程序来支持modbus，也可在罗克韦尔下载示例程序，下面对官网给出的示例程序作简要验证。</p> <p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/94EZlwQkXEJLqxAY/img/98b12361-4b42-4101-927e-47c54ac7f986.png" alt="img"></p> <ol><li>新建工程，选择MainRoutine，在右侧的空白区域点击右键选择Import Rungs</li></ol> <p><img src="/assets/img/image-20230518092658960.8f1ca896.png" alt="image-20230518092658960"></p> <ol start="2"><li><p>导入示例程序中的.L5X文件，可以修改程序内参数的名称，通过Tags标签的Final Name选项。</p> <p><img src="/assets/img/image-20230518092750982.cb36efca.png" alt="image-20230518092750982"></p></li> <li><p>点击ok导入，在Modbus TCP Client块内右键点击，选择Monitor。</p></li></ol> <p><img src="/assets/img/image-20230518092829622.30840c66.png" alt="image-20230518092829622"></p> <ol start="4"><li>对于5370系列而言，LocalSlot的值为0，将其他条目如EtherNet/IP的端口地址、Modbus从站的ip地址和端口号按实际进行填写</li></ol> <p><img src="/assets/img/image-20230518092950596.fb821f44.png" alt="image-20230518092950596"></p> <ol start="5"><li>回到MainRoutine选项，将inp_Enable置为1，代表启动Modbus Client功能，对于RSLogix 5000而言，同时需要将程序编译并下载到plc，最后切换到运行状态</li></ol> <p><img src="/assets/img/image-20230518093017397.da90aa14.png" alt="image-20230518093017397"></p> <ol start="6"><li>监控表可以设置Pollinterval（刷新时间）、Transtype（功能码）、Stationid（从站ID）、BeginAddress（起始地址）、Count（地址数量）等基本参数，此外还需要设置LocalAddress，此参数代表与Modbus Slave的起始地址对应的Modbus Client的起始地址。</li></ol> <p><img src="/assets/img/image-20230518093037433.23365c02.png" alt="image-20230518093037433"></p> <ol start="7"><li>Modbus Client同样使用4个寄存器存放数据，完成起始地址的映射后，可以直接修改寄存器内的数据，如此处将Slave的起始地址设为了40，修改coils下的数据可以发现，成功更新到了控制器的内部</li></ol> <p><img src="/assets/img/image-20230518093105083.1d180f97.png" alt="image-20230518093105083"></p> <p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/94EZlwQkXEJLqxAY/img/1c4e6957-307d-409a-9546-52ece9ec4ae3.png" alt="img"></p> <h3 id="西门子-6es7317-2ek14-0ab0"><a href="#西门子-6es7317-2ek14-0ab0" class="header-anchor">#</a> <strong>西门子</strong> 6ES7317-2EK14-0AB0</h3> <h4 id="profinet-2"><a href="#profinet-2" class="header-anchor">#</a> Profinet</h4> <ol><li>打开TIA Portal V15软件，点击创建新项目，弹出新建项目窗口后，更改项目名称（如jakaPNIO），然后点击浏览按钮，选择存储位置并确定，再点击创建，此时已经新建了一个项目并保存在了指定的路径下</li></ol> <p><img src="/assets/img/image-20230518094544786.1924d7c6.png" alt="image-20230518094544786"></p> <ol start="2"><li><p>在建立的项目窗口中，依次点击设备与网络-&gt;添加新设备-&gt;控制器, 选择PLC的型号，再点击添加<img src="/assets/img/image-20230518094635931.969a7ba7.png" alt="image-20230518094635931"></p></li> <li><p>双击PLC模块，在常规的菜单下点击以太网地址，修改PLC的IP地址</p></li></ol> <p><img src="/assets/img/image-20230518102245415.b8bcaf36.png" alt="image-20230518102245415"></p> <ol start="4"><li>如果使用了PLC S7-300则需要修改IO地址映射的大小，使地址映射值大于688字节，IO地址映射小于此值可能会导致数据丢失，因为我们Profinet IO的最大地址范围为0到688字节。</li></ol> <p><img src="/assets/img/image-20230518104643528.2f70be28.png" alt="image-20230518104643528"></p> <ol start="5"><li>在菜单栏选项菜单中，点击管理通用站描述文件(GSD)，弹出相应的窗口，点击浏览按钮，找到文件GSDML-V2.41-JAKA-JAKARobot-20210722.xml的路径，载入后选中该文件，然后安装， 等待安装完成，关闭窗口</li></ol> <p><img src="/assets/img/image-20230518102831965.2554233d.png" alt="image-20230518102831965"></p> <p><img src="/assets/img/image-20230518103105653.72fcff3f.png" alt="image-20230518103105653"></p> <ol start="6"><li>在左侧栏双击设备和网络，在右侧栏硬件目录，点击其他现场设备，选择PROFINET IO， 找到JAKA_V1.0, 双击或直接拖到界面即可</li></ol> <p><img src="/assets/img/image-20230518103207811.56f123f4.png" alt="image-20230518103207811"></p> <p><img src="/assets/img/image-20230518103309906.bacfe772.png" alt="image-20230518103309906"></p> <ol start="7"><li>点击Profinet设备的未分配，选择PLC_1.PROFINET接口_1</li></ol> <p><img src="/assets/img/image-20230518103916807.0596946d.png" alt="image-20230518103916807"></p> <p><img src="/assets/img/image-20230518103927603.60087096.png" alt="image-20230518103927603"></p> <ol start="8"><li>单击Profinet设备DP-NORM图标，在下方的菜单栏中选在以太网地址，修改Profinet设备的IP地址。</li></ol> <p><img src="/assets/img/image-20230518104002066.c9fac72a.png" alt="image-20230518104002066"></p> <ol start="9"><li>点击IO周期，在更新时间的区块选择手动设置更新时间，在更新时间的下拉框中更选择Profinet的数据更新时间，由于此设备的最小更新时间为8ms，所选择的数值应该大于或等于8ms。</li></ol> <p><img src="/assets/img/image-20230518104602841.bf8d1a5d.png" alt="image-20230518104602841"></p> <ol start="10"><li>双击名为jaka的Profinet设备，切换到硬件设备概览的页面，在硬件目录的模块下能看到被定义的各IO数据块。将数据块拖入到对应的插槽中。</li></ol> <p><img src="/assets/img/image-20230518104431792.1682aadc.png" alt="image-20230518104431792"></p> <p><img src="/assets/img/image-20230518104445644.8711abb4.png" alt="image-20230518104445644"></p> <p>11.切换到设备和网络界面，选中PLC，依次选择编译和下载的图标。</p> <p><img src="/assets/img/image-20230518104522946.dbb080f3.png" alt="image-20230518104522946"></p> <ol start="12"><li>双击左侧栏在线和诊断，在线访问的配置如下，然后点击转至在线， 即可观察PLC与Profinet连接情况，以及实现PLC和Profinet实时数据传输的观察。</li></ol> <p><img src="/assets/img/image-20230518104545379.bb59a49a.png" alt="image-20230518104545379"></p> <ol start="13"><li>在左边菜单栏监控和强制列表下，新建监控表，根据Profinet IO地址分配表，对DI、AI、DO和AO对应的地址进行操作，即可实现控制器和PLC之间的数据传输。</li></ol> <p><img src="/assets/img/image-20230518104918585.d8d1ef20.png" alt="image-20230518104918585"></p> <h4 id="modbus-tcp-2"><a href="#modbus-tcp-2" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="主站-2"><a href="#主站-2" class="header-anchor">#</a> 主站</h5> <p>西门子同样通过编程实现Modbus TCP协议，S7-300可以使用MODBUSPN模块</p> <ol><li>在工艺对象内插入MB_PN_PARAM</li></ol> <p><img src="/assets/img/image-20230518093906080.4748c11b.png" alt="image-20230518093906080"></p> <ol start="2"><li>进入组态进行连接设置，设定ip地址、端口号等参数</li></ol> <p><img src="/assets/img/image-20230518093934377.27b551d4.png" alt="image-20230518093934377"></p> <ol start="3"><li>设置Modbus的数据区域</li></ol> <p><img src="/assets/img/image-20230518105611813.3e05a16d.png" alt="image-20230518105611813"></p> <ol start="4"><li><p>根据工艺对象的数据区域，添加4个区域块<img src="/assets/img/image-20230518105629778.1602b435.png" alt="image-20230518105629778"></p></li> <li><p>创建数据块</p></li></ol> <p><img src="/assets/img/image-20230518105705600.db5e475f.png" alt="image-20230518105705600"></p> <ol start="6"><li>调用通信指令，设置对应参数</li></ol> <p><img src="data:image/png;base64,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" alt="image-20230518105726538"></p> <p><img src="/assets/img/image-20230518105736115.f2e94a8c.png" alt="image-20230518105736115"></p> <p>后续操作与罗克韦尔类似，在指令中对参数进行更改，可以与Modbus TCP通信，但此功能需要西门子的授权密钥</p> <h3 id="三菱-fx5u-80mt-dss"><a href="#三菱-fx5u-80mt-dss" class="header-anchor">#</a> 三菱 FX5U-80MT/DSS</h3> <h4 id="ethernet-ip-3"><a href="#ethernet-ip-3" class="header-anchor">#</a> EtherNet/IP</h4> <p>FX5U默认ip为192.168.3.250；FX5 ENET/IP默认ip为192.168.3.251</p> <p>需要使用扩展模块FX5-ENT/IP开启EtherNet/IP功能，此功能需要软件EtherNet/IP Configuration Tool for FX5-ENET/IP，可在三菱官网或联系供应商获取</p> <ol><li>使用GX works3登录FX5-ENET/IP的配置文件</li></ol> <p><img src="/assets/img/image-20230518105910148.98ca811d.png" alt="image-20230518105910148"></p> <p><img src="/assets/img/image-20230518105927689.a74de08b.png" alt="image-20230518105927689"></p> <ol start="2"><li>新建工程，选择对应型号的PLC</li></ol> <p><img src="/assets/img/image-20230518105953323.d523fb10.png" alt="image-20230518105953323"></p> <ol start="3"><li>从信息模块中拖入FX5-ENET/IP，与FX5U完成拼接</li></ol> <p><img src="/assets/img/image-20230518110033512.9681bfa3.png" alt="image-20230518110033512"></p> <ol start="4"><li>打开三菱EtherNet/IP Configuration Tool for FX5-ENET/IP工具，点击Description中add添加配置模块并更改地址，注意与模块的ip地址保持同一网段。</li></ol> <p><img src="/assets/img/image-20230518110108093.040fa273.png" alt="image-20230518110108093"></p> <ol start="5"><li>选择device library添加eds文件。</li></ol> <p><img src="/assets/img/image-20230518110127399.74826b1d.png" alt="image-20230518110127399"></p> <ol start="6"><li>将eds文件直接拖至TCP/IP下方，注意配置其ip与模块同网段。</li></ol> <p><img src="/assets/img/image-20230518110154849.cdb870a5.png" alt="image-20230518110154849"></p> <ol start="7"><li>可以使用配置界面的ping功能测试是否成功连接。</li></ol> <p><img src="/assets/img/image-20230518110211474.18c62193.png" alt="image-20230518110211474"></p> <ol start="8"><li>点击在线并将配置下载到模块</li></ol> <p><img src="/assets/img/image-20230518110240349.dabd1830.png" alt="image-20230518110240349"></p> <ol start="9"><li>由于三菱模块需要通过程序运行，且需要功能块激活，因此配置下载完成后需要回到主界面编程触发EtherNet/IP功能，安装了FX5-ENET/IP的配置文件后，部件库出现了自带的标准功能块，选择添加模块标签</li></ol> <p><img src="/assets/img/image-20230518110300653.456a45e7.png" alt="image-20230518110300653"></p> <ol start="10"><li>点击在线-当前连接目标进入连接界面</li></ol> <p><img src="/assets/img/image-20230518110328253.ee763df8.png" alt="image-20230518110328253"></p> <ol start="11"><li>点击其他连接方法，打开连接目标指定画面</li></ol> <p><img src="/assets/img/image-20230518110348372.397a21de.png" alt="image-20230518110348372"></p> <ol start="12"><li>双击设备网络进行FX5U的ip设置</li></ol> <p><img src="/assets/img/image-20230518110409610.d177f8d8.png" alt="image-20230518110409610"></p> <ol start="13"><li>点击搜索，双击搜索出的设备并点击确认</li></ol> <p><img src="/assets/img/image-20230518110426467.0f2ecfde.png" alt="image-20230518110426467"></p> <ol start="14"><li>点击通信测试，此时应显示已成功连接</li></ol> <p><img src="/assets/img/image-20230518110443487.133b223b.png" alt="image-20230518110443487"></p> <ol start="15"><li>添加M+FX5ENETIP_Class1SetOutputdata_01A模块测试发送数据功能，编写测试程序如下</li></ol> <p><img src="/assets/img/image-20230518110510258.42001e32.png" alt="image-20230518110510258"></p> <ol start="16"><li>此时EtherNet/IP Configuration Tool for FX5-ENET/IP已配置完成，点击全部转换并写入FX5U</li></ol> <p><img src="/assets/img/image-20230518110529816.974cbdeb.png" alt="image-20230518110529816"></p> <ol start="17"><li>全选并执行写入，然后重置PLC，可以通过断电的方式实现，注意此时网线应接入FX5U单元。</li></ol> <p><img src="/assets/img/image-20230518110550181.f8665998.png" alt="image-20230518110550181"></p> <ol start="18"><li>使用模块触发EIP功能后，此时APP侧应显示成功连接主站</li></ol> <p><img src="/assets/img/image-20230518110608603.849d5736.png" alt="image-20230518110608603"></p> <ol start="19"><li>若在EtherNet/IP Configuration Tool for FX5-ENET/IP进行诊断，将显示设备正常在线</li></ol> <p><img src="/assets/img/image-20230518110636975.6384f899.png" alt="image-20230518110636975"></p> <ol start="20"><li>重启后将网线从FX5U拔下并接入FX5-ENET/IP，同样进入在线-当前连接目标确认与EIP模块的通信正常，然后打开监视</li></ol> <p><img src="/assets/img/image-20230518110654282.733fc1c5.png" alt="image-20230518110654282"></p> <ol start="21"><li>光标放在M1001开关，使用Shift+Enter改变输入信号触发此函数功能块</li></ol> <p><img src="/assets/img/image-20230518110711675.e4f084f7.png" alt="image-20230518110711675"></p> <ol start="22"><li>右键函数块，打开在线-软元件/缓冲存储器批量监视</li></ol> <p><img src="/assets/img/image-20230518110726137.9eabbbca.png" alt="image-20230518110726137"></p> <ol start="23"><li>监视D1015并更新，此时数据应更新到DI和AI</li></ol> <p><img src="/assets/img/image-20230518110747795.24c8c6a2.png" alt="image-20230518110747795"></p> <ol start="24"><li>浮点数同理，可以通过监看窗口查看对应软元件的值，需要注意的是，软元件存储器以16位为单元存储数据，有符号整数和浮点数都需要高低位共同组成准确的32位数据</li></ol> <p><img src="/assets/img/image-20230518110812748.ec65d0f7.png" alt="image-20230518110812748"></p> <ol start="25"><li>拖入M+FX5ENETIP_Class1Getinputdate_01A模块测试接收数据功能，编写测试程序如下，每次编译写入需要将网线插在CPU单元，即FX5U，而实际使用EIP功能时，需要将网线插回FX5-ENET/IP</li></ol> <p><img src="/assets/img/image-20230518110832871.369e732c.png" alt="image-20230518110832871"></p> <ol start="26"><li>在APP修改DO和AO的值，观察值的更新</li></ol> <p><img src="/assets/img/image-20230518110853851.a8f6a38d.png" alt="image-20230518110853851"></p> <ol start="27"><li>浮点数同理</li></ol> <p><img src="/assets/img/image-20230518110910926.6821e456.png" alt="image-20230518110910926"></p> <h4 id="modbus-tcp-3"><a href="#modbus-tcp-3" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="从站"><a href="#从站" class="header-anchor">#</a> 从站</h5> <ol><li>打开以太网设置下的Modbus/TCP设置，双击对象设备连接配置设置</li></ol> <p><img src="/assets/img/image-20230518162141616.6951a103.png" alt="image-20230518162141616"></p> <ol start="2"><li>将Modbus/TCP连接设备拖入网络拓扑中，反映设置并关闭</li></ol> <p><img src="/assets/img/image-20230518111007916.8e1df04d.png" alt="image-20230518111007916"></p> <ol start="3"><li>此时Modbus/TCP设置应显示使用，双击详细设置进入软元件分配，分配完成后点击确认，再点击应用</li></ol> <p><img src="/assets/img/image-20230518111025673.58a32b80.png" alt="image-20230518111025673"></p> <ol start="4"><li>将修改后的模块参数写入PLC内，然后重置PLC</li></ol> <p><img src="/assets/img/image-20230518111042541.23d63c3a.png" alt="image-20230518111042541"></p> <ol start="5"><li>APP此时可以运行扩展IO模块，查看值是否更新到对应地址</li></ol> <p><img src="/assets/img/image-20230518111057725.c7658fd5.png" alt="image-20230518111057725"></p> <p><img src="/assets/img/image-20230518111111202.0bb46a70.png" alt="image-20230518111111202"></p> <p><img src="/assets/img/image-20230518111122339.700fb840.png" alt="image-20230518111122339"></p> <h5 id="主站-3"><a href="#主站-3" class="header-anchor">#</a> 主站</h5> <ol><li>点击模块参数的以太网端口，双击对象设备连接配置设置的详细设置进入配置页面，拖入Active连接设备，选择通信手段为通信协议，设定端口号和IP等信息，注意三菱PLC使用Modbus只能通过502端口，设置完成后反映设置并关闭，点击应用</li></ol> <p><img src="/assets/img/image-20230518111135968.1eafa151.png" alt="image-20230518111135968"></p> <ol start="2"><li>点击工具-通讯协议支持功能</li></ol> <p><img src="/assets/img/image-20230518111150850.3341e69a.png" alt="image-20230518111150850"></p> <ol start="3"><li>选择以太网，点击确定</li></ol> <p><img src="/assets/img/image-20230518111203910.dfd11161.png" alt="image-20230518111203910"></p> <ol start="4"><li>点击添加，选择Modbus/TCP，并添加协议名。</li></ol> <p><img src="/assets/img/image-20230518111220121.00f58de7.png" alt="image-20230518111220121"></p> <ol start="5"><li>可以多次添加协议名，最多支持64个协议号</li></ol> <p><img src="/assets/img/image-20230518111236492.6056644c.png" alt="image-20230518111236492"></p> <ol start="6"><li>如果不熟悉软元件的分配方法，可以直接自动分配数据包的软元件，右键空白区域，点击软元件批量设置</li></ol> <p><img src="/assets/img/image-20230518111250414.32af8519.png" alt="image-20230518111250414"></p> <ol start="7"><li>指定软元件的协议号范围和起始软元件号，点击确定</li></ol> <p><img src="/assets/img/image-20230518111306694.8e44c173.png" alt="image-20230518111306694"></p> <ol start="8"><li>此时显示变量已设置，也可点击工具-设置软元件一览显示查看具体的分配方法</li></ol> <p><img src="/assets/img/image-20230518111330610.0a502c74.png" alt="image-20230518111330610"></p> <ol start="9"><li>以功能码为15的分配规则，D304为连接编号，D305为模块ID，D306为起始地址，D307为写入长度，D308为可变长度，指定写入数据的字节长度，D309-D1292为写入的具体数据。</li></ol> <p><img src="/assets/img/image-20230518111347364.8e6f9d8c.png" alt="image-20230518111347364"></p> <ol start="10"><li>分配完成后将此模块写入PLC，注意此处的设置为单独写入，从GX Works3主界面执行的写入并不会写入此模块的信息</li></ol> <p><img src="/assets/img/image-20230518111403627.3700de5c.png" alt="image-20230518111403627"></p> <ol start="11"><li>写入完成后需要编写程序触发此通信协议，三菱PLC作为Modbus主站时主要用到三条指令，可以参考<em>MELSEC iQ-F FX5用户手册(MODBUS通信篇)</em>，指令的详细含义可以按F1查看官方的指令帮助</li></ol> <p><img src="/assets/img/image-20230518111415825.4140798b.png" alt="image-20230518111415825"></p> <ol start="12"><li>此处介绍一种通信方法，可根据自己的逻辑需求修改程序，使用SP.SOCOPEN打开连接</li></ol> <p><img src="/assets/img/image-20230518111430357.8940eb86.png" alt="image-20230518111430357"></p> <ol start="13"><li>对连接进行设置，主要依据上述的软元件分配表的地址</li></ol> <p><img src="/assets/img/image-20230518111503241.13f1e870.png" alt="image-20230518111503241"></p> <ol start="14"><li>使用SP.ECPRTCL调用通信协议编号进行写入</li></ol> <p><img src="/assets/img/image-20230518111517448.372c6b30.png" alt="image-20230518111517448"></p> <ol start="15"><li>使用SP.SOCCLOSE关闭连接</li></ol> <p><img src="/assets/img/image-20230518111531756.adbe1b9f.png" alt="image-20230518111531756"></p> <ol start="16"><li>点击转换程序并写入PLC，此程序逻辑会循环使用通信协议编号1，由于SP.ECPRTCL不会打开关闭连接，因此使用时需要结合SP.SOCOPEN和SP.SOCCLOSE，点击监视并打开软元件/缓冲存储器批量监视</li></ol> <p><img src="/assets/img/image-20230518111546412.c7a49989.png" alt="image-20230518111546412"></p> <ol start="17"><li>可以看到，值正确地更新到了对应的寄存器</li></ol> <p><img src="/assets/img/image-20230518162249818.25d3dfa3.png" alt="image-20230518162249818"></p> <ol start="18"><li>针对02功能码，情况类似，确认软元件的分配并修改程序即可</li></ol> <p><img src="/assets/img/image-20230518111616942.2ebb4871.png" alt="image-20230518111616942"></p> <ol start="19"><li>主要需要将协议编号和连续读取编号修改为2</li></ol> <p><img src="/assets/img/image-20230518111637363.b1887733.png" alt="image-20230518111637363"></p> <ol start="20"><li>同样转换程序并下载到PLC，可以看到DO的值更新到了D1307中</li></ol> <p><img src="/assets/img/image-20230518111657433.8b25d677.png" alt="image-20230518111657433"></p> <h3 id="施耐德-tm241ce24r"><a href="#施耐德-tm241ce24r" class="header-anchor">#</a> 施耐德 TM241CE24R</h3> <h4 id="ethernet-ip-4"><a href="#ethernet-ip-4" class="header-anchor">#</a> EtherNet/IP</h4> <p>首先需要确保TM241CE24R的固件版本与Machine Expert匹配，否则无法正常使用，如果版本不对使用controller assistant升降级固件版本。</p> <ol><li>使用Machine Expert添加eds文件</li></ol> <p><img src="/assets/img/image-20230518111842828.7be9e2ec.png" alt="image-20230518111842828"></p> <p><img src="/assets/img/image-20230518111916343.53352162.png" alt="image-20230518111916343"></p> <p><img src="/assets/img/image-20230518111927256.d531d5f8.png" alt="image-20230518111927256"></p> <ol start="2"><li>双击控制器点击刷新可以看到当前连接设备，也可以通过网线直连修改外部设备的IP地址</li></ol> <p><img src="/assets/img/image-20230518111942759.b7de047d.png" alt="image-20230518111942759"></p> <ol start="3"><li>修改时勾选永久保存</li></ol> <p><img src="/assets/img/image-20230518111956473.6bd623df.png" alt="image-20230518111956473"></p> <ol start="4"><li>此时已经成功修改，将TM241CE24R连接在交换机，JAKA APP与控制器也接入此交换机并保持均在同一网段</li></ol> <p><img src="/assets/img/image-20230518112018441.e1ad95bb.png" alt="image-20230518112018441"></p> <ol start="5"><li>右键点击Ethernet_1添加设备</li></ol> <p><img src="/assets/img/image-20230518112047746.2e6aa6fe.png" alt="image-20230518112047746"></p> <ol start="6"><li>选择Modbus TCP下的Industrial Ethernet Manager</li></ol> <p><img src="/assets/img/image-20230518112116359.78bbbaa1.png" alt="image-20230518112116359"></p> <ol start="7"><li>继续右键点击Industrial Ethernet Manager添加JAKA设备</li></ol> <p><img src="/assets/img/image-20230518112139664.bf5bce82.png" alt="image-20230518112139664"></p> <ol start="8"><li>编译并登录设备，如果提示安全相关，无视并按ALT+F8继续登录</li></ol> <p><img src="/assets/img/image-20230518112153726.658efd4f.png" alt="image-20230518112153726"></p> <ol start="9"><li>改为始终使能后，点击开始</li></ol> <p><img src="/assets/img/image-20230518112222107.9381595b.png" alt="image-20230518112222107"></p> <ol start="10"><li>此时APP侧应显示成功连接主站</li></ol> <p><img src="/assets/img/image-20230518112233861.76150ce9.png" alt="image-20230518112233861"></p> <ol start="11"><li>修改DO和AO的值，可以看到对应的Input Exclusive owner[144]、[150]、[154]和发生了变化，这是由于从ROBOT到PLC的数据包含了ROBOT的状态数据，因此DO是从72开始的，JAKA的EtherNet/IP使用32位数据，而Machine Expert使用16位数据，因此最终DO的地址从144开始</li></ol> <p><img src="/assets/img/image-20230518112249241.20ef853a.png" alt="image-20230518112249241"></p> <ol start="12"><li>在输出中使用ctrl+F7将值传递给机器人，值同样正常更新</li></ol> <p><img src="/assets/img/image-20230518112303178.9743d4b1.png" alt="image-20230518112303178"></p> <h4 id="modbus-tcp-4"><a href="#modbus-tcp-4" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="主站-4"><a href="#主站-4" class="header-anchor">#</a> 主站</h5> <ol><li>右键点击Ethernet_1添加modbus slave设备</li></ol> <p><img src="/assets/img/image-20230518112326838.687d878b.png" alt="image-20230518112326838"></p> <ol start="2"><li>设置主站的IP地址等信息</li></ol> <p><img src="/assets/img/image-20230518112340540.a6703bb1.png" alt="image-20230518112340540"></p> <ol start="3"><li>登录并开始，监视数据</li></ol> <p><img src="/assets/img/image-20230518112355272.697909fa.png" alt="image-20230518112355272"></p> <ol start="4"><li>TM241CE24R支持的modbus从站的保持寄存器的功能码为03、06和16，而输入寄存器支持的功能码为17，JAKA机器人modbus主站暂不支持此功能码，使用前需要查阅官方文档</li></ol> <p><img src="/assets/img/image-20230518112408357.02692942.png" alt="image-20230518112408357"></p> <h3 id="欧姆龙-cp1h-x40dt-d"><a href="#欧姆龙-cp1h-x40dt-d" class="header-anchor">#</a> 欧姆龙 CP1H-X40DT-D</h3> <p>CP1H的CPU单元本身不带EIP的功能，因此需要装扩展单元，在此之前需要先再装一个CJ1W-EXT01扩展单元以支持扩展，安装后的产品如图：</p> <p><img src="/assets/img/image-20230518112534078.746a378f.png" alt="image-20230518112534078"></p> <p>由于欧姆龙的modbus均属于无协议通讯，也即通过软件实现其通信，而且需要额外选装硬件，如需要CJ1W-ETN21支持modbustcp和 CP1W-CIF11支持modbusrtu，因此不对其做验证。</p> <h4 id="ethernet-ip-5"><a href="#ethernet-ip-5" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li>使用CX-Programmer作为上位机，新建工程</li></ol> <p><img src="/assets/img/image-20230518112558888.9d19b06b.png" alt="image-20230518112558888"></p> <ol start="2"><li>PLC默认的地址为192.168.250.1，先使用网线直连，切换到在线模式并开启编程才能修改参数</li></ol> <p><img src="/assets/img/image-20230518112611668.1be99681.png" alt="image-20230518112611668"></p> <ol start="3"><li>创建IO表，初始化CPU总线</li></ol> <p><img src="/assets/img/image-20230518112625082.d6240b62.png" alt="image-20230518112625082"></p> <ol start="4"><li>此时有了EIP模块</li></ol> <p><img src="/assets/img/image-20230518112637340.d7ac3c55.png" alt="image-20230518112637340"></p> <ol start="5"><li>修改EIP21模块的IP地址后，将参数从PC传递至单元并重启，使用修改的IP地址连接PLC</li></ol> <p><img src="/assets/img/image-20230518112648277.3454b4ac.png" alt="image-20230518112648277"></p> <ol start="6"><li>启动专用的应用程序，继承启动</li></ol> <p><img src="/assets/img/image-20230518112704443.72c8ef92.png" alt="image-20230518112704443"></p> <ol start="7"><li>选择第二项进行EIP设定</li></ol> <p><img src="/assets/img/image-20230518112716651.f8c42c2c.png" alt="image-20230518112716651"></p> <ol start="8"><li>安装eds文件</li></ol> <p><img src="/assets/img/image-20230518112728140.e0592110.png" alt="image-20230518112728140"></p> <ol start="9"><li>选择上载</li></ol> <p><img src="/assets/img/image-20230518112746186.e8e039ce.png" alt="image-20230518112746186"></p> <ol start="10"><li>将导入的设备拖到总线，修改ip地址</li></ol> <p><img src="/assets/img/image-20230518112807626.5ea1b552.png" alt="image-20230518112807626"></p> <ol start="11"><li>进行连接注册</li></ol> <p><img src="/assets/img/image-20230518112818721.c31bbf6a.png" alt="image-20230518112818721"></p> <ol start="12"><li>进行变量的设置</li></ol> <p><img src="/assets/img/image-20230518112841189.3ebd5fe8.png" alt="image-20230518112841189"></p> <ol start="13"><li>设置完成后将参数修改到plc</li></ol> <p><img src="/assets/img/image-20230518112852640.83d86a18.png" alt="image-20230518112852640"></p> <ol start="14"><li>点击下载到设备</li></ol> <p><img src="/assets/img/image-20230518112907042.cbbb4deb.png" alt="image-20230518112907042"></p> <ol start="15"><li>无视警告并继续</li></ol> <p><img src="/assets/img/image-20230518112920804.90a4c656.png" alt="image-20230518112920804"></p> <ol start="16"><li>下载完成后将重启plc</li></ol> <p><img src="/assets/img/image-20230518112933858.7f6a793e.png" alt="image-20230518112933858"></p> <ol start="17"><li>此时APP侧应显示成功连接主站，将plc的工作模式切换为监视，可以实现值的传递</li></ol> <p><img src="/assets/img/image-20230518112952130.6e1c3421.png" alt="image-20230518112952130"></p> <p><img src="/assets/img/image-20230518113001361.a270c448.png" alt="image-20230518113001361"></p> <h3 id="基恩士-kv-8000"><a href="#基恩士-kv-8000" class="header-anchor">#</a> 基恩士 KV-8000</h3> <p>本例采用KV-8000作为CPU单元，KV-XLE02作为扩展单元</p> <h4 id="ethernet-ip-6"><a href="#ethernet-ip-6" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li>使用KV STUDIO新建工程，在初次使用以太网单元时，需要打开单元编辑器</li></ol> <p><img src="/assets/img/image-20230518113104728.0c14b233.png" alt="image-20230518113104728"></p> <ol start="2"><li>拖动单元到KV-8000上，如果已经连接CPU单元，也可以选择直接从PLC读取单元组态</li></ol> <p><img src="/assets/img/image-20230518113118159.3fdcd6e5.png" alt="image-20230518113118159"></p> <ol start="3"><li>设置端口的协议为scanner，（此处如果不设置将不会显示ethernetip设定），分别设置KV-8000和KV-XLE02的IP地址，最后应用设置。</li></ol> <p><img src="/assets/img/image-20230518113139022.df59b97c.png" alt="image-20230518113139022"></p> <ol start="4"><li>回到KV-STUDIO，选择监视器/模拟器的通信设定，选择EtherNet/IP或USB进行扫描，需要将PC与PLC使用网线或USB连接。选择EtherNet/IP进行扫描时，选择网卡并执行，可以扫描出对应的设备，扫描到设备后点击选择设备。</li></ol> <p><img src="/assets/img/image-20230518113151146.329caf2e.png" alt="image-20230518113151146"></p> <ol start="5"><li>点击转换到PLC，选择执行，执行后会将单元编辑器内的以太网设定也一并写入PLC，如果在单元编辑器内修改了KV-8000的IP地址和KV-XLE02的通信协议，写入完成后设备的网络参数也会发生改变。另外KV-XLE02的两个端口的网络部须保持不同。</li></ol> <p><img src="/assets/img/image-20230518113205943.e80fbfc9.png" alt="image-20230518113205943"></p> <ol start="6"><li>导入JAKA的eds文件</li></ol> <p><img src="/assets/img/image-20230518113220030.e15c5406.png" alt="image-20230518113220030"></p> <ol start="7"><li>本例将port 1的IP地址设置为192.168.1.10，重复上述选择设备的步骤，将网线接入KV-XLE02，选择此设备，回到单元编辑器，点击EtherNet/IP设定</li></ol> <p><img src="/assets/img/image-20230518113234996.d3549d33.png" alt="image-20230518113234996"></p> <ol start="8"><li>将JAKA设备的IP地址设置为与PLC同一网段，本例中为192.168.1.20/24，点击自动设定，将自动扫描网络拓扑</li></ol> <p><img src="/assets/img/image-20230518113247405.cc0f23f5.png" alt="image-20230518113247405"></p> <ol start="9"><li>回到KV STUDIO，将EtherNet/IP设定和单元编辑器下载到PLC，此时APP测应显示成功连接主站。</li></ol> <p><img src="/assets/img/image-20230518113301551.b92eda65.png" alt="image-20230518113301551"></p> <ol start="10"><li>回到单元编辑器的EtherNet/IP设定，点击Exclusive Owner的Edit，可以选择自动分配软元件或手动分配，此处选择自动。基恩士定义的EtherNet/IP设备的通信数据的数据类型为位和字，数据的显示方式根据类型变化。针对非基恩士的设备，使用自动分配，选择字设备</li></ol> <p><img src="/assets/img/image-20230518113313000.1444d464.png" alt="image-20230518113313000"></p> <p><img src="/assets/img/image-20230518113328040.b7575e48.png" alt="image-20230518113328040"></p> <ol start="11"><li>保存设置，由于JAKA的数据默认占32位，而KV-STUDIO的数据类型默认为WORD，占16位，当使用WORD的数据类型时，JAKA的DI对应到PLC从IN_101[144]开始，DO从OUT_100[0]开始，打开监视窗口</li></ol> <p><img src="/assets/img/image-20230518113348198.dc6407ca.png" alt="image-20230518113348198"></p> <ol start="12"><li>在APP和KV STUDIO修改参数，查看各软元件和APP的值，由于KV STUDIO默认的数据类型为WORD，因此使用时需要进行高低位的拼接处理。</li></ol> <p><img src="/assets/img/image-20230518113405110.9d8639ca.png" alt="image-20230518113405110"></p> <h4 id="modbus-tcp-5"><a href="#modbus-tcp-5" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="从站-2"><a href="#从站-2" class="header-anchor">#</a> 从站</h5> <ol><li>KV-XLE02作为从站时不需要发送接收用的梯形图程序，进入单元编辑器打开PROTOCOL STUDIO开关</li></ol> <p><img src="/assets/img/image-20230518113423247.c3f7feff.png" alt="image-20230518113423247"></p> <ol start="2"><li>在单元设置中对Modbus的所有相关参数进行配置，如IP地址、modbus TCP端口号、线圈和寄存器地址等。默认值中，只读软元件（输入/输入寄存器）被设定为与可读写软元件（线圈/保持寄存器）相同的分配。</li></ol> <p><img src="/assets/img/image-20230518113439809.3de16f6f.png" alt="image-20230518113439809"></p> <ol start="3"><li>将单元编辑器的配置写入PLC，启动监视模式，此时从站成功开启，选择从站的寄存器地址进行监视，需要注意的是，默认情况下KV-XLE02的只读软元件（输入/输入寄存器）被设定为与可读写软元件（线圈/保持寄存器）相同的分配，可以按照需求自行分配。此处为了区分做了一定区别。</li></ol> <p><img src="/assets/img/image-20230518113452997.fec87c36.png" alt="image-20230518113452997"></p> <ol start="4"><li>打开JAKA扩展IO，点击运行，修改参数后再KV STUDIO读取和发送对应地址的参数，可以看到参数的同步更新</li></ol> <p><img src="/assets/img/image-20230518113506874.fa565d89.png" alt="image-20230518113506874"></p> <h3 id="台达-as228t-a"><a href="#台达-as228t-a" class="header-anchor">#</a> 台达 AS228T-A</h3> <h4 id="ethernet-ip-7"><a href="#ethernet-ip-7" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li><p>针对台达的AS系列，需要从HWCONFIG打开EIP BUILDER，否则没有AS系列的选项，如果是更新的版本，可以直接在HWCONFIG完成EIP的配置和网络拓扑</p> <p>新建工程，双击HWCONFIG</p></li></ol> <p><img src="/assets/img/image-20230518114351122.85cd5c64.png" alt="image-20230518114351122"></p> <ol start="2"><li>安装设备描述文件管理工具</li></ol> <p><img src="/assets/img/image-20230518114402845.873b4908.png" alt="image-20230518114402845"></p> <ol start="3"><li>右键单击PLC设备，选择通讯软件的EtherNet/IP</li></ol> <p><img src="/assets/img/image-20230518114417537.9ccc938e.png" alt="image-20230518114417537"></p> <ol start="4"><li>搜索导入的jaka描述信息，将其拖拽到组态网络内，然后双击jaka设备修改IP地址</li></ol> <p><img src="/assets/img/image-20230518114434556.a56cc2f6.png" alt="image-20230518114434556"></p> <ol start="5"><li>点击快速连线，将设备连接在同一网络内，然后下载到设备</li></ol> <p><img src="/assets/img/image-20230518114538549.448c33c7.png" alt="image-20230518114538549"></p> <ol start="6"><li>点击显示数据交换，设置主站寄存器地址，最后将相关数据下载到PLC</li></ol> <p><img src="/assets/img/image-20230518114554764.4f024790.png" alt="image-20230518114554764"></p> <ol start="7"><li>下载完成后应显示成功连接主站</li></ol> <p><img src="/assets/img/image-20230518114606575.5b34d766.png" alt="image-20230518114606575"></p> <ol start="8"><li>关闭并保存HWCONFIG，回到ISPSoft，点击联机模式，弹出项目比对不符，点击是执行下载</li></ol> <p><img src="/assets/img/image-20230518114622309.7b529fe8.png" alt="image-20230518114622309"></p> <ol start="9"><li>点击装置监控表，新建监控表，新建地址变量</li></ol> <p><img src="/assets/img/image-20230518114636722.ae51466e.png" alt="image-20230518114636722"></p> <ol start="10"><li>监视DO和AO的变化，浮点数同理</li></ol> <p><img src="/assets/img/image-20230518114651737.bcce5485.png" alt="image-20230518114651737"></p> <p><img src="/assets/img/image-20230518114659624.3ed1e6cb.png" alt="image-20230518114659624"></p> <ol start="11"><li>监视DI和AI的值，根据设定，DI的值从D1000开始，浮点数同理</li></ol> <p><img src="/assets/img/image-20230518114717985.076de027.png" alt="image-20230518114717985"></p> <p><img src="/assets/img/image-20230518114731299.03bdd66d.png" alt="image-20230518114731299"></p> <h4 id="modbus-tcp-6"><a href="#modbus-tcp-6" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="从站-3"><a href="#从站-3" class="header-anchor">#</a> 从站</h5> <ol><li>官网可以找到设备标准MODBUS的地址，可以直接访问这些地址来实现对台达PLC Modbus从站的访问，端口号默认为502，其中MODBUS位址的第一位代表访问的寄存器类型</li></ol> <p><img src="/assets/img/image-20230518114801539.c7f72e54.png" alt="image-20230518114801539"></p> <ol start="2"><li>在装置监控表监控数据，以对Y、M、D的访问为例</li></ol> <p><img src="/assets/img/image-20230518114815951.2258b4c2.png" alt="image-20230518114815951"></p> <p><img src="/assets/img/image-20230518114825506.73ae0960.png" alt="image-20230518114825506"></p> <h5 id="主站-5"><a href="#主站-5" class="header-anchor">#</a> 主站</h5> <ol><li>双击进入HWCONFIG，双击硬件配置，双击设备图标</li></ol> <p><img src="/assets/img/image-20230518114843299.3d0050df.png" alt="image-20230518114843299"></p> <ol start="2"><li>进入数据交换的以太网，此处代表Modbus TCP端口的触发方式，修改为永久执行，当PLC上电时会始终启用，修改完成后添加数据交换规则，设置远程装置类型为标准Modbus设备，分别设置IP地址、本机起始地址、远程起始地址和数量，注意远程起始地址使用十六进制，设置完成后将参数下载到设备</li></ol> <p><img src="/assets/img/image-20230518114859097.effadfe0.png" alt="image-20230518114859097"></p> <ol start="3"><li>关闭HWCONFIG，打开联机选项，监控数据表，可以观察到所有数据的更新</li></ol> <p><img src="/assets/img/image-20230518114912260.c8108fe1.png" alt="image-20230518114912260"></p> <ol start="4"><li>由于JAKA Modbus从站对浮点数采用的是大端显示，因此高位字节被存储在地位字节，按照台达PLC的显示规则为</li></ol> <p><img src="/assets/img/image-20230518114927755.e7e686fe.png" alt="image-20230518114927755"></p> <h3 id="汇川-easy522‐0808tn"><a href="#汇川-easy522‐0808tn" class="header-anchor">#</a> 汇川 Easy522‑0808TN</h3> <h4 id="ethernet-ip-8"><a href="#ethernet-ip-8" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li>打开AutoShop，新建工程，选择PLC型号，进入工具的通讯设置</li></ol> <p><img src="/assets/img/image-20230518115022404.e6c3ba11.png" alt="image-20230518115022404"></p> <ol start="2"><li>点击搜索设备</li></ol> <p><img src="/assets/img/image-20230518115035421.ffc0f9ac.png" alt="image-20230518115035421"></p> <ol start="3"><li>选择导入eds文件</li></ol> <p><img src="/assets/img/image-20230518115049518.ccfce288.png" alt="image-20230518115049518"></p> <ol start="4"><li>导入成功后双击设备添加组态</li></ol> <p><img src="/assets/img/image-20230518115102151.081aed63.png" alt="image-20230518115102151"></p> <ol start="5"><li>编译后下载到设备，并将设备切换到运行状态</li></ol> <p><img src="/assets/img/image-20230518115114620.f9f08567.png" alt="image-20230518115114620"></p> <ol start="6"><li>此时设备应显示成功连接主站，并且配置中的EtherNet/IP显示的都是绿色</li></ol> <p><img src="/assets/img/image-20230518115128368.764bdc62.png" alt="image-20230518115128368"></p> <ol start="7"><li>使用数字输出和有符号输出，可以正常更新到PLC</li></ol> <p><img src="/assets/img/image-20230518115145588.7b369013.png" alt="image-20230518115145588"></p> <ol start="8"><li>浮点数也可以正常更新</li></ol> <p><img src="/assets/img/image-20230518115220157.d2721a20.png" alt="image-20230518115220157"></p> <ol start="9"><li>从PLC输出数据到机器人</li></ol> <p><img src="/assets/img/image-20230518115234702.dae66c14.png" alt="image-20230518115234702"></p> <p><img src="/assets/img/image-20230518115245433.a77f1846.png" alt="image-20230518115245433"></p> <h4 id="modbus-tcp-7"><a href="#modbus-tcp-7" class="header-anchor">#</a> Modbus TCP</h4> <h5 id="从站-4"><a href="#从站-4" class="header-anchor">#</a> 从站</h5> <ol><li>Easy-522作为从站时，设置IP地址即开启了Modbus从站功能，无需设置通信协议，配置JAKA的扩展IO，使用502端口即可和Easy-522通信</li></ol> <p><img src="/assets/img/image-20230518115310208.a1683534.png" alt="image-20230518115310208"></p> <ol start="2"><li>Easy-522的文档规定了线圈和寄存器可以访问的地址，线圈和寄存器共用地址。</li></ol> <p><img src="/assets/img/image-20230518115327406.bb98dbdc.png" alt="image-20230518115327406"></p> <p><img src="/assets/img/image-20230518115338147.32707297.png" alt="image-20230518115338147"></p> <h5 id="主站-6"><a href="#主站-6" class="header-anchor">#</a> 主站</h5> <ol><li>Easy-522作为主站，添加以太网配置，参数为JAKA机器人的地址和Modbus端口</li></ol> <p><img src="/assets/img/image-20230518115355406.1f989351.png" alt="image-20230518115355406"></p> <ol start="2"><li>右键打开并新增从站站号，分别进行配置，分配映射地址后点击确认</li></ol> <p><img src="/assets/img/image-20230518115410000.8344e546.png" alt="image-20230518115410000"></p> <ol start="3"><li>打开软元件表，监视D200-D400的值，按照上图的分配，地址映射如下：</li></ol> <p>DI 0-9 : D200-209</p> <p>DO 0-9 : D210-D219</p> <p>AI 0-9 : D220-229</p> <p>AO 0-9 : D230-D239</p> <p>分别使用读取内存和写入内存可以观察值的更新</p> <p><img src="/assets/img/image-20230518115425621.72385fed.png" alt="image-20230518115425621"></p> <h3 id="codesys"><a href="#codesys" class="header-anchor">#</a> Codesys</h3> <h4 id="ethernet-ip-9"><a href="#ethernet-ip-9" class="header-anchor">#</a> EtherNet/IP</h4> <ol><li>下载并安装codesys后，会在后台出现CODESYS Gateway Systray -x64和CODESYS Control Win Systray -x64，前者是网关的开关，后者为虚拟PLC的开关，使用时需要确保二者都处于运行状态。</li></ol> <p><img src="/assets/img/image-20230220181755889.41b20b51.png" alt="image-20230220181755889"></p> <ol start="2"><li>打开Codesys并新建工程，选择standard project，首次使用codesys会提示创建用户，之后使用plc时均需要使用此信息进行用户登录。</li></ol> <p><img src="/assets/img/image-20230220183201360.28451e34.png" alt="image-20230220183201360"></p> <p><img src="/assets/img/image-20230220182339657.132ff8a3.png" alt="image-20230220182339657"></p> <ol start="3"><li>选择CODESYS Control Win V3 x64作为PLC型号，第二栏默认即可。</li></ol> <p><img src="/assets/img/image-20230220182401950.db6fee1e.png" alt="image-20230220182401950"></p> <ol start="4"><li>在Codesys 菜单栏-工具-设备存储库，点击“安装”导入eds文件。导入后会出现提示，同时文件会出现在EthernetIP总线的远程适配器下。</li></ol> <p><img src="/assets/img/image-20230220182205612.c75f00f0.png" alt="image-20230220182205612"></p> <p><img src="/assets/img/image-20230220182610006.d4f52bba.png" alt="image-20230220182610006"></p> <ol start="5"><li>在Codesys中分别逐级添加EtherNet-&gt;EtherNet_IP_Scanner。</li></ol> <p><img src="/assets/img/image-20230220182807248.3c3bddc8.png" alt="image-20230220182807248"></p> <ol start="6"><li>双击EtherNet选择与外部设备相连的网口，点击ok。如果组网中已有匹配该eds文件的JAKA控制器，并且使能了EtherNet/IP功能，右键单击EtherNet_IP_Scanner进行设备扫描，可以看到符合条件的设备，单击复制到工程；如果未成功扫描，也可以手动添加设备并配置其ip地址。</li></ol> <p><img src="/assets/img/image-20230220183555384.e7d14dc2.png" alt="image-20230220183555384"></p> <p><img src="/assets/img/image-20230220184201136.091df792.png" alt="image-20230220184201136"></p> <ol start="7"><li>依次点击登录和运行按钮，当设备栏的scanner和adapter均变为绿色后，代表设备成功连接，此时APP侧应同步显示成功连接主站。</li></ol> <p><img src="/assets/img/image-20230220184343914.f367ad8f.png" alt="image-20230220184343914"></p> <p><img src="/assets/img/image-20230220184357323.4a3f617c.png" alt="image-20230220184357323"></p> <p><img src="/assets/img/image-20230220184636633.6a7fa787.png" alt="image-20230220184636633"></p> <p><img src="/assets/img/image-20230220184522233.060320d3.png" alt="image-20230220184522233"></p> <p><img src="/assets/img/image-20230220184803673.f351202d.png" alt="image-20230220184803673"></p> <ol start="8"><li>打开jaka adapter的IO映射将总是更新处改为使能1，修改此选项需要先退出PLC登录。再次登录可以发现，数据已经开始同步更新。</li></ol> <p><img src="/assets/img/image-20230220185017565.4f6016b7.png" alt=""></p> <p><img src="/assets/img/image-20230220185223933.c88eecb4.png" alt="image-20230220185223933"></p> <ol start="9"><li>从控制器到PLC，分别修改DO和AO的数据，可以看到，对应地址的参数发生了更新。<img src="/assets/img/image-20230220185334508.b5c40349.png" alt="image-20230220185334508"></li></ol> <p><img src="/assets/img/image-20230220185419800.8f6c3700.png" alt="image-20230220185419800"></p> <ol start="10"><li>从PLC到控制器，分别在预备值栏修改DI和AI的值，并同时按下ctrl+F7将数据提交，可以看到对应的数据发生了更新。</li></ol> <p><img src="/assets/img/image-20230220185633320.495b885c.png" alt="image-20230220185633320"></p> <p><img src="/assets/img/image-20230220185713370.8e2378f3.png" alt="image-20230220185713370"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>目前已验证的PLC型号与对应的通讯协议汇总如下：</p> <table><thead><tr><th>型号</th> <th>厂商</th> <th>Modbus TCP</th> <th>EtherNet/IP(scanner)</th> <th>Profinet(controller)</th></tr></thead> <tbody><tr><td>5370 L3 1769-L33ER</td> <td>罗克韦尔</td> <td>√</td> <td>√</td> <td></td></tr> <tr><td>6ES7317-2EK14-0AB0</td> <td>西门子</td> <td>√</td> <td>√</td> <td>√</td></tr> <tr><td>FX5U-80MT/DSS</td> <td>三菱</td> <td>√</td> <td>√</td> <td></td></tr> <tr><td>TM241CE24R</td> <td>施耐德</td> <td>√</td> <td>√</td> <td></td></tr> <tr><td>CP1H-X40DT-D</td> <td>欧姆龙</td> <td></td> <td>√</td> <td></td></tr> <tr><td>KV-8000</td> <td>基恩士</td> <td>√</td> <td>√</td> <td></td></tr> <tr><td>AS228T-A</td> <td>台达</td> <td>√</td> <td>√</td> <td></td></tr> <tr><td>Easy522‑0808TN</td> <td>汇川</td> <td>√</td> <td>√</td> <td></td></tr></tbody></table> <p>针对上述测定的PLC型号，通讯协议与节卡目前所支持的主从协议均良好兼容，可以正常使用。需要注意的是，由于各PLC厂家对数据类型和长度的规定，可能无法做到完全兼容，需要对数据做拼接等处理。</p> <h2 id="问题排查"><a href="#问题排查" class="header-anchor">#</a> 问题排查</h2> <p>出现无法连接或无法使能的情况，可以按以下条目进行初步分析和处理。</p> <h3 id="检查设备网段是否相同"><a href="#检查设备网段是否相同" class="header-anchor">#</a> 检查设备网段是否相同</h3> <p>检查设备是否处于同一网段，可以使用wireshark抓包分析，也可以使用ping对网络进行测试，确保设备之间通信状况良好。</p> <h3 id="从app确认ethernet-ip的状态"><a href="#从app确认ethernet-ip的状态" class="header-anchor">#</a> 从APP确认EtherNet/IP的状态</h3> <p>修改EtherNet/IP使能状态和网络状态后，需要对控制器进行重启以更新配置，Profinet同理，可以从APP确认是否处在与主站交互的状态判断连接。</p> <h3 id="检查接线是否正常"><a href="#检查接线是否正常" class="header-anchor">#</a> 检查接线是否正常</h3> <p>PLC最好走底部网口网线直连，此时APP应通过wifi或面板网口直连控制器以提供更好的通信质量。</p> <h3 id="从plc查看状态"><a href="#从plc查看状态" class="header-anchor">#</a> 从PLC查看状态</h3> <p>通过上位机软件检测PLC的状态，确认其处于运行状态并且正常工作，如Codesys数据更新的前提是必须打开数据映射选项的”使能1“。</p> <h3 id="查看终端界面打印信息"><a href="#查看终端界面打印信息" class="header-anchor">#</a> 查看终端界面打印信息</h3> <p>在终端界面上使用jkzuc命令重启控制器程序，查看EtherNet/IP的相关打印信息，包括使能状态、IO配置模式、网卡名称、IP地址、与master连接状态等，确认信息是否匹配或正常。</p> <p><img src="/assets/img/image-20230220190231581.0906e8bf.png" alt="image-20230220190231581"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次修改:</span> <span class="time">2023/5/23 03:54:26</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/guide/jks.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        JAKA编程脚本
      </a></span> <!----></p></div> <div class="page-anchor collapse-page-anchor"><div class="ant-space ant-space-vertical" style="width:100%;"><div class="ant-space-item"><div class="page-anchor-offset"><div><div class="ant-anchor-wrapper" style="max-height:100vh;"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a href="#介绍" title="介绍" class="ant-anchor-link-title">介绍</a><div class="ant-anchor-link"><a href="#环境搭建" title="环境搭建" class="ant-anchor-link-title">环境搭建</a></div><div class="ant-anchor-link"><a href="#使能ethernet-ip功能" title="使能EtherNet/IP功能" class="ant-anchor-link-title">使能EtherNet/IP功能</a></div></div><div class="ant-anchor-link"><a href="#io数量配置方法" title="IO数量配置方法" class="ant-anchor-link-title">IO数量配置方法</a><div class="ant-anchor-link"><a href="#ethernet-ip" title="EtherNet/IP" class="ant-anchor-link-title">EtherNet/IP</a></div><div class="ant-anchor-link"><a href="#profinet" title="Profinet" class="ant-anchor-link-title">Profinet</a></div></div><div class="ant-anchor-link"><a href="#plc通讯实例" title="PLC通讯实例" class="ant-anchor-link-title">PLC通讯实例</a><div class="ant-anchor-link"><a href="#罗克韦尔5370-l3-1769-l33er" title="罗克韦尔5370 L3 1769-L33ER" class="ant-anchor-link-title">罗克韦尔5370 L3 1769-L33ER</a></div><div class="ant-anchor-link"><a href="#西门子-6es7317-2ek14-0ab0" title="西门子 6ES7317-2EK14-0AB0" class="ant-anchor-link-title">西门子 6ES7317-2EK14-0AB0</a></div><div class="ant-anchor-link"><a href="#三菱-fx5u-80mt-dss" title="三菱 FX5U-80MT/DSS" class="ant-anchor-link-title">三菱 FX5U-80MT/DSS</a></div><div class="ant-anchor-link"><a href="#施耐德-tm241ce24r" title="施耐德 TM241CE24R" class="ant-anchor-link-title">施耐德 TM241CE24R</a></div><div class="ant-anchor-link"><a href="#欧姆龙-cp1h-x40dt-d" title="欧姆龙 CP1H-X40DT-D" class="ant-anchor-link-title">欧姆龙 CP1H-X40DT-D</a></div><div class="ant-anchor-link"><a href="#基恩士-kv-8000" title="基恩士 KV-8000" class="ant-anchor-link-title">基恩士 KV-8000</a></div><div class="ant-anchor-link"><a href="#台达-as228t-a" title="台达 AS228T-A" class="ant-anchor-link-title">台达 AS228T-A</a></div><div class="ant-anchor-link"><a href="#汇川-easy522‐0808tn" title="汇川 Easy522‑0808TN" class="ant-anchor-link-title">汇川 Easy522‑0808TN</a></div><div class="ant-anchor-link"><a href="#codesys" title="Codesys" class="ant-anchor-link-title">Codesys</a></div></div><div class="ant-anchor-link"><a href="#总结" title="总结" class="ant-anchor-link-title">总结</a></div><div class="ant-anchor-link"><a href="#问题排查" title="问题排查" class="ant-anchor-link-title">问题排查</a><div class="ant-anchor-link"><a href="#检查设备网段是否相同" title="检查设备网段是否相同" class="ant-anchor-link-title">检查设备网段是否相同</a></div><div class="ant-anchor-link"><a href="#从app确认ethernet-ip的状态" title="从APP确认EtherNet/IP的状态" class="ant-anchor-link-title">从APP确认EtherNet/IP的状态</a></div><div class="ant-anchor-link"><a href="#检查接线是否正常" title="检查接线是否正常" class="ant-anchor-link-title">检查接线是否正常</a></div><div class="ant-anchor-link"><a href="#从plc查看状态" title="从PLC查看状态" class="ant-anchor-link-title">从PLC查看状态</a></div><div class="ant-anchor-link"><a href="#查看终端界面打印信息" title="查看终端界面打印信息" class="ant-anchor-link-title">查看终端界面打印信息</a></div></div></div></div></div></div></div></div></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.97ce11a3.js" defer></script><script src="/assets/js/3.5fb538b3.js" defer></script><script src="/assets/js/2.e2beffe6.js" defer></script>
  </body>
</html>