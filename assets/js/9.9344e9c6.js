(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1152:function(t,s,a){t.exports=a.p+"assets/img/showcase.a845188b.png"},1153:function(t,s,a){t.exports=a.p+"assets/img/run_addOn.00186c20.gif"},1154:function(t,s,a){t.exports=a.p+"assets/img/developPage.01a9b62d.png"},1155:function(t,s,a){t.exports=a.p+"assets/media/open_coustomer_node.fa6d5e03.mp4"},1156:function(t,s,a){t.exports=a.p+"assets/img/creat_block.148d5ca0.gif"},1157:function(t,s,a){t.exports=a.p+"assets/img/Add_Http.57d4df37.gif"},1158:function(t,s,a){t.exports=a.p+"assets/img/program_hello.bbf58bd2.gif"},1159:function(t,s,a){t.exports=a.p+"assets/img/自定义指令生成失败.1adf3b67.png"},1160:function(t,s,a){t.exports=a.p+"assets/img/AddOn没有运行.888c8775.png"},1161:function(t,s,a){t.exports=a.p+"assets/img/统一名称.d5588b6a.png"},1162:function(t,s,a){t.exports=a.p+"assets/img/服务器内部错误.01814901.png"},1163:function(t,s,a){t.exports=a.p+"assets/img/属性匹配失败.db86b142.png"},1164:function(t,s,a){t.exports=a.p+"assets/img/检查属性名.5c4c4ed7.png"},1165:function(t,s,a){t.exports=a.p+"assets/img/debug.249e6774.png"},1166:function(t,s,a){t.exports=a.p+"assets/img/debug1.95a87799.png"},1167:function(t,s,a){t.exports=a.p+"assets/img/debug2.fe31825a.png"},1168:function(t,s,a){t.exports=a.p+"assets/img/debug3.535b0d2b.png"},1695:function(t,s,a){"use strict";a.r(s);var n=a(81),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"自定义指令开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义指令开发"}},[t._v("#")]),t._v(" 自定义指令开发")]),t._v(" "),s("p",[s("strong",[t._v("该页面旨在指导开发者如何开发具有自定义指令功能的AddOn包。")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("请注意：")]),t._v(" "),s("p",[t._v("本章为入门教程，主要目的是使开发者了解自定义指令的基础知识与基本开发流程。")]),t._v(" "),s("p",[t._v("若需了解如何开发带有具体应用功能、应用于具体工艺场景的自定义指令AddOn包，请参考后续的完整案例章节：。")])]),t._v(" "),s("h2",{attrs:{id:"关于自定义指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关于自定义指令"}},[t._v("#")]),t._v(" 关于自定义指令")]),t._v(" "),s("h3",{attrs:{id:"自定义指令是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义指令是什么"}},[t._v("#")]),t._v(" 自定义指令是什么")]),t._v(" "),s("p",[t._v("自定义指令是指开发者根据自己的需求，在符合JAKA脚本规则的情况下，开发出的除JAKA App内标准程序指令之外的其他指令。")]),t._v(" "),s("h3",{attrs:{id:"自定义指令的作用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义指令的作用"}},[t._v("#")]),t._v(" 自定义指令的作用")]),t._v(" "),s("p",[t._v("如简介中所述，当机器人末端连接了新的第三方工具，或是应用于具体工作场景中去操作具体工艺时，往往需要在JAKA App编程界面编写繁杂的指令、设置繁多的参数。这一步骤较复杂，且不易于二次复用，所以此时就需要把这些繁、杂、多的指令和参数封装为一条直接易懂、简单易用的指令块，以节约时间成本、提升操作效率。")]),t._v(" "),s("h2",{attrs:{id:"创建addon自定义指令包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建addon自定义指令包"}},[t._v("#")]),t._v(" 创建AddOn自定义指令包")]),t._v(" "),s("p",[t._v("在此处的示范中，我们将创建一个自定义指令类型的AddOn，该AddOn的功能是将指令块上输入和选择的内容显示在App日志中。\n")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1152)}})]),s("p"),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("注：")]),t._v(" "),s("p",[t._v("下文中的JAKA_Command就是我们即将创建的AddOn自定义指令包的包名。")])]),t._v(" "),s("h3",{attrs:{id:"步骤一-创建addon文件夹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤一-创建addon文件夹"}},[t._v("#")]),t._v(" 步骤一：创建AddOn文件夹")]),t._v(" "),s("p",[t._v("首先我们需要创建一个AddOn基本文件夹，该文件夹需包含一个.ini格式的配置文件和一个保存数据的json文件。")]),t._v(" "),s("p",[t._v("您可以从头开始手动创建，也可以使用AddOn开发包仓库中 "),s("a",{attrs:{href:"https://github.com/JakaCobot/jaka_addon_kit",target:"_blank",rel:"noopener noreferrer"}},[t._v('"'),s("em",[t._v("Template")]),t._v('"'),s("OutboundLink")],1),t._v(" 目录下的AddOn模板进行修改。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("目录结构")]),t._v(" "),s("p",[t._v("|——JAKA_Command"),s("br"),t._v("\n   |——AddOn.json"),s("br"),t._v("\n   |——JAKA_Command_config.ini")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("AddOn.json")]),s("br"),t._v("\njson文件内容为空即可，后面的步骤中会自动生成数据写入。")]),t._v(" "),s("li",[s("strong",[t._v("JAKA_Command_config.ini")]),s("br"),t._v(" "),s("RouterLink",{attrs:{to:"/guide/addOn/iniConfig.html"}},[t._v("配置文件👈")]),t._v("内容如下:"),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[t._v("AddOnInfo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("convention")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("3.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("JAKA_Command")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("description")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token inner-value"}},[t._v("在日志中输出信息")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("portal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10006")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("http://localhost/myAddOnUi")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("languagetype")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("node-red")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("AddOn.json")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("serviceenabled")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1")]),t._v("\n")])])])],1)]),t._v(" "),s("h3",{attrs:{id:"步骤二-打包-上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤二-打包-上传"}},[t._v("#")]),t._v(" 步骤二：打包&上传")]),t._v(" "),s("p",[t._v("接下来我们会将步骤一中创建好的文件夹打包，上传至控制器中进行指令块开发，打包的要求格式为"),s("code",[t._v(".tar.gz")]),t._v("。")]),t._v(" "),s("p",[t._v("在Windows中您可以使用7z等打包工具进行二次压缩。"),s("br")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(655)}})]),s("p"),t._v(" "),s("p",[t._v("在App中附加管理程序页面上传AddOn。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(656)}})]),t._v(" "),s("h3",{attrs:{id:"步骤三-开发自定义指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤三-开发自定义指令"}},[t._v("#")]),t._v(" 步骤三：开发自定义指令")]),t._v(" "),s("ol",[s("li",[t._v("运行AddOn并查看AddOn运行的端口号。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1153)}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("打开浏览器，在地址栏中输入机器人IP及端口号"),s("code",[t._v("IP:Portal")]),t._v("进入开发者界面。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(1154)}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("在左侧工具栏中找到"),s("code",[t._v("Customized Commands")]),t._v("节点，拖入画布中，点击部署。")])]),t._v(" "),s("p",[t._v("双击"),s("code",[t._v("Customized Commands")]),t._v("节点，打开指令块生成工具页面。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("video",{attrs:{width:"1000",controls:"",autoplay:""}},[s("source",{attrs:{src:a(1155),type:"video/mp4"}})])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[s("p",[t._v("在"),s("em",[t._v("基本配置")]),t._v("页面中定义指令块的样式和属性，这里使用页面案例自带的属性，不做更改。")])]),t._v(" "),s("li",[s("p",[t._v("更改指令块名称为"),s("em",[t._v("hello_jaka")]),t._v("，颜色为绿色。")])]),t._v(" "),s("li",[s("p",[t._v("在"),s("em",[t._v("脚本生成")]),t._v("页面中定义指令块的行为，这里使用页面案例自带的脚本，不做更改。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(1156)}})]),t._v(" "),s("ul",[s("li",[t._v("此处所使用的脚本语言为JAKA编程脚本，具体语法请参考"),s("RouterLink",{attrs:{to:"/guide/jks.html"}},[t._v("JAKA编程脚本👈")]),t._v("。\n")],1)])]),t._v(" "),s("li",[s("p",[t._v("当在App中保存自定义指令时，会通过http的get请求获取脚本，因此需要使用"),s("code",[t._v("http in")]),t._v("和"),s("code",[t._v("http response")]),t._v("节点完善流程。")])])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(1157)}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("请注意：")]),t._v(" "),s("p",[s("code",[t._v("http in")]),t._v(" 节点的url要与自定义指令块的名称一致。")])]),t._v(" "),s("h3",{attrs:{id:"步骤四-运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤四-运行"}},[t._v("#")]),t._v(" 步骤四：运行")]),t._v(" "),s("p",[t._v("在node-red中部署流程后，在附加程序页面点击刷新按钮，即可在App中编程页面的扩展指令中找到刚才制作的指令块。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(1158)}})]),t._v(" "),s("h2",{attrs:{id:"调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调试"}},[t._v("#")]),t._v(" 调试")]),t._v(" "),s("p",[t._v("在开发过程中，可能会遇到如下问题，具体情况及相应调试方法请看下文。")]),t._v(" "),s("p",[s("strong",[t._v("自定义指令生成失败")]),s("br"),t._v("\n在App编程页面使用自定义指令块后，点击保存，报错“自定义指令生成失败”，可能是以下几个原因导致的。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1159)}})]),t._v(" "),s("ol",[s("li",[s("p",[t._v("AddOn没有运行"),s("br"),t._v("\n解决方法：在附加程序页面找到该AddOn，点击运行按钮开启AddOn。\n")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1160)}})]),s("p")]),t._v(" "),s("li",[s("p",[t._v("node-red中的"),s("code",[t._v("http in")]),t._v("节点中url与指令块名字不一致"),s("br"),t._v("\n解决方法：将url与指令块名称统一。\n")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1161)}})]),s("p")])]),t._v(" "),s("p",[s("strong",[t._v("服务器内部错误")]),s("br"),t._v("\n当遇到服务器内部错误时，一般都是因为App没有收到Http请求的响应超时导致。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1162)}})]),t._v(" "),s("p",[t._v("解决方法：检查node-red端的"),s("code",[t._v("http in")]),t._v("节点是否正确连接"),s("code",[t._v("http response")]),t._v("节点，连接后在App端重启AddOn。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("-目前恢复连接后任然需要重启AddOn服务，才能正常保存程序。这是内部的一些未知bug导致，会在后续版本修复。"),s("br"),t._v("\n-报错信息中请重启控制器的描述有误，重启AddOn即可。")])]),t._v(" "),s("p",[s("strong",[t._v("属性匹配失败")]),s("br")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1163)}})]),s("p"),t._v(" "),s("p",[t._v("解决方法：检查node-red中自定义指令的属性名称是否与脚本定义中用到的一致。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1164)}})]),t._v(" "),s("p",[s("strong",[t._v("如何检查通讯收发的参数是否正确？")])]),t._v(" "),s("ul",[s("li",[t._v("node-red中使用debug节点进行调试。可以调试保存时指令块发来的参数和返回的jks是否正确。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1165)}})]),t._v(" "),s("p",[t._v("保存或运行程序时，App发起Get请求。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1166)}})]),t._v(" "),s("p",[t._v("此时debug1可以捕获到请求中传入的参数对象。该对象的键为指令块上属性的名字，值为属性的具体内容，包括属性值和属性类型。")]),t._v(" "),s("p",[t._v("以下面收到的内容为例，“Select1”为定义的下拉框属性名，“value”为属性值，0代表此时选中了下拉框的第一个选项。“type”为指令块上填入参数的类型，该参数仅对输入框类型的属性有意义。0表示输入框内为手动写入的值，1表示输入框内放入了变量类型的内容（系统变量、计算结果等数据类型的指令块）。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1167)}})]),t._v(" "),s("p",[t._v("debug2打印的信息中包含了本次保存生成的Jks脚本的对象。")]),t._v(" "),s("p",[t._v("其中error_code为生成Jks的错误码，0是生成正常，-12为内部错误。当该错误码不等于0时，App会弹窗报错相应的错误码和错误信息。我们这里只需要关注“jks”这个属性即可，该属性的值即为实际生产的Jks脚本。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(1168)}})]),t._v(" "),s("p",[s("strong",[t._v("模拟生成脚本")])]),t._v(" "),s("ul",[s("li",[t._v("脚本生成页面，在左侧指令块上输入参数后，点击“生成Jks脚本”可模拟生成脚本，在下方代码窗口内查看模拟生成的代码。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:""}})]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("请注意：")]),t._v(" "),s("p",[t._v("点击“生成Jks脚本”按钮只是在下方的代码窗口中显示模拟生成的脚本，并没有其他实际的作用。")])])])}),[],!1,null,null,null);s.default=e.exports},655:function(t,s,a){t.exports=a.p+"assets/img/compress_addon.01c8b684.gif"},656:function(t,s,a){t.exports=a.p+"assets/img/upLoad_addon.aedec686.png"}}]);