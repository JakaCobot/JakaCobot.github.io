(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1461:function(t,s,a){"use strict";a.r(s);var e=a(81),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"自定义指令基础"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义指令基础"}},[t._v("#")]),t._v(" 自定义指令基础")]),t._v(" "),s("p",[s("strong",[t._v("通过创建JAKA_Command了解自定义指令类型AddOn的开发流程和基础知识。")])]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("  我们将创建一个自定义指令类型的AddOn，当运行该指令时将根据指令块上的内容在App日志中输出不同的内容。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(911)}})]),t._v(" "),s("h2",{attrs:{id:"创建jaka-command"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建jaka-command"}},[t._v("#")]),t._v(" 创建JAKA_Command")]),t._v(" "),s("h3",{attrs:{id:"step1-创建addon包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step1-创建addon包"}},[t._v("#")]),t._v(" Step1:创建AddOn包")]),t._v(" "),s("p",[t._v("  首先我们需要创建一份AddOn基本文件，包含一个.ini格式的配置文件和一个保存数据的json文件。您可以从头开始手动创建，也可以使用AddOn开发包仓库中 "),s("a",{attrs:{href:"https://github.com/JakaCobot/jaka_addon_kit",target:"_blank",rel:"noopener noreferrer"}},[t._v('"'),s("em",[t._v("Template")]),t._v('"'),s("OutboundLink")],1),t._v(" 目录下的AddOn模板进行修改。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("目录结构")]),t._v(" "),s("p",[t._v("|——JAKA_Command"),s("br"),t._v("\n   |——AddOn.json"),s("br"),t._v("\n   |——JAKA_Command_config.ini")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("AddOn.json")]),s("br"),t._v("\n  json文件内容为空即可，后面的步骤中会自动生成数据写入。")]),t._v(" "),s("li",[s("strong",[t._v("JAKA_Command_config.ini")]),s("br"),t._v(" "),s("RouterLink",{attrs:{to:"/guide/addOn/iniConfig.html"}},[t._v("配置文件")]),t._v("内容如下:"),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[t._v("AddOnInfo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("convention")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("3.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("JAKA_Command")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("description")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token inner-value"}},[t._v("在日志中输出信息")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1.0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("portal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10006")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("http://localhost/myAddOnUi")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("languagetype")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("node-red")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("AddOn.json")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("serviceenabled")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1")]),t._v("\n")])])])],1)]),t._v(" "),s("h3",{attrs:{id:"step2-打包-上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step2-打包-上传"}},[t._v("#")]),t._v(" Step2:打包&上传")]),t._v(" "),s("p",[t._v("  接下来我们会将AddOn打包，上传至控制器中进行指令块开发。打包的要求格式为"),s("code",[t._v(".tar.gz")]),t._v("。在Windows中您可以使用7z等打包工具进行二次压缩。"),s("br")]),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(657)}})]),t._v("\n  在App中附加管理程序页面上传AddOn。"),s("br"),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(658)}})]),s("p"),t._v(" "),s("h3",{attrs:{id:"step3-开发自定义指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step3-开发自定义指令"}},[t._v("#")]),t._v(" Step3:开发自定义指令")]),t._v(" "),s("ol",[s("li",[t._v("运行AddOn并查看AddOn运行的端口号。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(654)}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("使用"),s("code",[t._v("IP:Port")]),t._v("进入开发者界面。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(655)}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[t._v("在左侧工具栏中找到"),s("code",[t._v("Customized Commands")]),t._v("节点，拖入画布中，点击部署。")])]),t._v(" "),s("li",[s("p",[t._v("双击"),s("code",[t._v("Customized Commands")]),t._v("节点，打开指令块生成工具页面。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("video",{attrs:{width:"1000",controls:"",autoplay:""}},[s("source",{attrs:{src:a(653),type:"video/mp4"}})])])]),t._v(" "),s("li",[s("p",[t._v("更改指令块名称为"),s("em",[t._v("hello_jaka")]),t._v(",颜色为绿色。")])]),t._v(" "),s("li",[s("p",[t._v("在"),s("em",[t._v("基本配置")]),t._v("页面中定义了指令块的样式和属性，这里使用自带的属性不做更改。")])]),t._v(" "),s("li",[s("p",[t._v("在"),s("em",[t._v("脚本生成")]),t._v("页面定义指令块的行为，这里使用自带的脚本不做更改。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(656)}})]),t._v(" "),s("ul",[s("li",[t._v("节卡脚本语法请参考"),s("RouterLink",{attrs:{to:"/guide/jks.html"}},[t._v("JAKA编程脚本")]),t._v("。")],1),t._v(" "),s("li",[t._v("更详细的"),s("code",[t._v("Customized Commands")]),t._v("节点使用方法请参考"),s("RouterLink",{attrs:{to:"/guide/addOn/Commands_Tool.html"}},[t._v("自定义指令创建节点")])],1)])]),t._v(" "),s("li",[s("p",[t._v("当在App中保存自定义指令时，会通过http的get请求获取脚本，因此需要使用"),s("code",[t._v("http in")]),t._v("和"),s("code",[t._v("http response")]),t._v("节点完善流程。")])])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(912)}})]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("注意！")]),t._v(" "),s("p",[s("code",[t._v("http in")]),t._v(" 节点的url要与自定义指令块的名称一致！")])]),t._v(" "),s("h3",{attrs:{id:"step4-运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step4-运行"}},[t._v("#")]),t._v(" Step4:运行")]),t._v(" "),s("p",[t._v("  在node-red中部署流程后，即可在App中使用该指令块。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"1000",src:a(913)}})]),t._v(" "),s("h2",{attrs:{id:"多语言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多语言"}},[t._v("#")]),t._v(" 多语言")]),t._v(" "),s("p",[t._v("在制作自定义指令时，支持多语言的内容输入框右侧会有一个小地球图标，点击即可配置多语言。目前支持中英日三种语言。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"500",src:a(914)}})]),t._v(" "),s("h2",{attrs:{id:"调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调试"}},[t._v("#")]),t._v(" 调试")]),t._v(" "),s("ul",[s("li",[t._v("node-red中使用debug节点进行调试。可以调试保存时指令块发来的参数和返回的jks是否正确。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(915)}})]),t._v(" "),s("p",[t._v("保存或运行程序时，App发起Get请求。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(916)}})]),t._v(" "),s("p",[t._v("此时debug1可以捕获到请求中的传参。“Select1”为定义的属性名，“value”为该属性的值，即指令块上填入的内容。“type”为指令块上填入参数的类型，0表示输入框内为手动写入的值，1表示输入框内放入了变量。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(917)}})]),t._v(" "),s("p",[t._v("debug2中可以看到包含了Jks脚本的对象。其中error_code为生成Jks的错误码，0是生成正常，-12为内部错误。当该错误码不等于0时，App会弹窗报错相应的错误码和错误信息。jksstr中包含了type（指令块类型）jks（指令块脚本）jks_return(指令块返回值) 。lines为指令块脚本的行数，自动计算生成。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(918)}})]),t._v(" "),s("ul",[s("li",[t._v("脚本生成页面，在左侧指令块上输入参数后，点击“生成jks脚本”可模拟生成脚本，在下方代码栏内查看模拟生成的代码。")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{width:"800",src:a(919)}})])])}),[],!1,null,null,null);s.default=n.exports},653:function(t,s,a){t.exports=a.p+"assets/media/open_coustomer_node.fa6d5e03.mp4"},654:function(t,s,a){t.exports=a.p+"assets/img/run_addOn.00186c20.gif"},655:function(t,s,a){t.exports=a.p+"assets/img/developPage.01a9b62d.png"},656:function(t,s,a){t.exports=a.p+"assets/img/creat_block.148d5ca0.gif"},657:function(t,s,a){t.exports=a.p+"assets/img/compress_addon.01c8b684.gif"},658:function(t,s,a){t.exports=a.p+"assets/img/upLoad_addon.aedec686.png"},911:function(t,s,a){t.exports=a.p+"assets/img/showcase.23bc5a40.png"},912:function(t,s,a){t.exports=a.p+"assets/img/Add_Http.57d4df37.gif"},913:function(t,s,a){t.exports=a.p+"assets/img/program_hello.bbf58bd2.gif"},914:function(t,s,a){t.exports=a.p+"assets/img/multiLan.37eaa187.png"},915:function(t,s,a){t.exports=a.p+"assets/img/debug.249e6774.png"},916:function(t,s,a){t.exports=a.p+"assets/img/debug1.95a87799.png"},917:function(t,s,a){t.exports=a.p+"assets/img/debug2.fe31825a.png"},918:function(t,s,a){t.exports=a.p+"assets/img/debug3.535b0d2b.png"},919:function(t,s,a){t.exports=a.p+"assets/img/debug4.83528438.png"}}]);